/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CustomClassPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/editorExtension.ts
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var PATTERNS = {
  // # Header ::: class
  HEADER: /^(#{1,6})\s+(.+?)\s+(:::\s*[\w-]+(?:\s*:\s*[\w-]+)*)\s*$/,
  // - item ::: class or - [ ] item ::: class
  LIST_ITEM: /^(\s*[-*+])\s+(?:\[[ xX]\]\s+)?(.+?)\s+(:::\s*[\w-]+(?:\s*:\s*[\w-]+)*)\s*$/,
  // > [!type] Title ::: class
  CALLOUT: /^>\s*\[!\w+\](.*?)\s+(:::\s*[\w-]+(?:\s*:\s*[\w-]+)*)\s*$/,
  // ```lang ::: class
  CODE_BLOCK: /^```(\w*)\s*(.*?)\s*(:::\s*[\w-]+(?:\s*:\s*[\w-]+)*)\s*$/,
  // ::: class (block start)
  BLOCK_START: /^:::\s*([\w-]+(?:\s*:\s*[\w-]+)*)\s*$/,
  // ::: (block end)
  BLOCK_END: /^:::\s*$/
};
var markerDecoration = import_view.Decoration.mark({ class: "ccs-syntax-marker" });
var classDecoration = import_view.Decoration.mark({ class: "ccs-class-name" });
var escapedDecoration = import_view.Decoration.mark({ class: "ccs-escaped" });
function isEscapedAt(text, position) {
  if (position <= 0) return false;
  let count = 0;
  let i = position - 1;
  while (i >= 0 && text[i] === "\\") {
    count++;
    i--;
  }
  return count % 2 === 1;
}
function buildDecorations(view) {
  const builder = new import_state.RangeSetBuilder();
  const doc = view.state.doc;
  const text = doc.toString();
  const lines = text.split("\n");
  const decorations = [];
  let lineOffset = 0;
  let inCodeBlock = false;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    const lineStart = lineOffset;
    const lineEnd = lineOffset + line.length;
    if (line.trim().startsWith("```")) {
      if (!inCodeBlock) {
        inCodeBlock = true;
        const match = line.match(PATTERNS.CODE_BLOCK);
        if (match) {
          const markerStart = line.lastIndexOf(":::");
          if (markerStart !== -1 && !isEscapedAt(line, markerStart)) {
            decorations.push({
              from: lineStart + markerStart,
              to: lineStart + markerStart + 3,
              decoration: markerDecoration
            });
            const classStart = markerStart + 3;
            const classEnd = line.length;
            if (classEnd > classStart) {
              decorations.push({
                from: lineStart + classStart,
                to: lineStart + classEnd,
                decoration: classDecoration
              });
            }
          }
        }
      } else {
        inCodeBlock = false;
      }
      lineOffset = lineEnd + 1;
      continue;
    }
    if (inCodeBlock) {
      lineOffset = lineEnd + 1;
      continue;
    }
    const escapedMatch = line.match(/\\:::/g);
    if (escapedMatch) {
      let pos = 0;
      while (pos < line.length) {
        const idx = line.indexOf("\\:::", pos);
        if (idx === -1) break;
        decorations.push({
          from: lineStart + idx,
          to: lineStart + idx + 4,
          decoration: escapedDecoration
        });
        pos = idx + 4;
      }
    }
    const trimmed = line.trim();
    if (PATTERNS.BLOCK_START.test(trimmed)) {
      const markerStart = line.indexOf(":::");
      if (markerStart !== -1 && !isEscapedAt(line, markerStart)) {
        decorations.push({
          from: lineStart + markerStart,
          to: lineStart + markerStart + 3,
          decoration: markerDecoration
        });
        const afterMarker = markerStart + 3;
        const classEnd = line.trimEnd().length;
        if (classEnd > afterMarker) {
          decorations.push({
            from: lineStart + afterMarker,
            to: lineStart + classEnd,
            decoration: classDecoration
          });
        }
      }
    } else if (PATTERNS.BLOCK_END.test(trimmed)) {
      const markerStart = line.indexOf(":::");
      if (markerStart !== -1 && !isEscapedAt(line, markerStart)) {
        decorations.push({
          from: lineStart + markerStart,
          to: lineStart + markerStart + 3,
          decoration: markerDecoration
        });
      }
    }
    for (const pattern of [PATTERNS.HEADER, PATTERNS.LIST_ITEM, PATTERNS.CALLOUT]) {
      const match = line.match(pattern);
      if (match) {
        const markerStart = line.lastIndexOf(":::");
        if (markerStart !== -1 && !isEscapedAt(line, markerStart)) {
          decorations.push({
            from: lineStart + markerStart,
            to: lineStart + markerStart + 3,
            decoration: markerDecoration
          });
          const classStart = markerStart + 3;
          const classEnd = line.trimEnd().length;
          if (classEnd > classStart) {
            decorations.push({
              from: lineStart + classStart,
              to: lineStart + classEnd,
              decoration: classDecoration
            });
          }
        }
        break;
      }
    }
    const inlineCodeRegex = /`[^`]+`\s*:::\s*[\w-]+(?:\s*:\s*[\w-]+)*/g;
    let inlineMatch;
    while ((inlineMatch = inlineCodeRegex.exec(line)) !== null) {
      const markerPos = inlineMatch[0].indexOf(":::");
      const globalPos = inlineMatch.index + markerPos;
      if (!isEscapedAt(line, globalPos)) {
        decorations.push({
          from: lineStart + globalPos,
          to: lineStart + inlineMatch.index + inlineMatch[0].length,
          decoration: markerDecoration
        });
      }
    }
    const inlineTextRegex = /:::(.+?):::/g;
    while ((inlineMatch = inlineTextRegex.exec(line)) !== null) {
      if (isEscapedAt(line, inlineMatch.index)) continue;
      decorations.push({
        from: lineStart + inlineMatch.index,
        to: lineStart + inlineMatch.index + 3,
        decoration: markerDecoration
      });
      const inner = inlineMatch[1];
      const lastColon = inner.lastIndexOf(":");
      if (lastColon > 0) {
        const classEnd = inlineMatch.index + 3 + lastColon;
        decorations.push({
          from: lineStart + inlineMatch.index + 3,
          to: lineStart + classEnd,
          decoration: classDecoration
        });
      }
      decorations.push({
        from: lineStart + inlineMatch.index + inlineMatch[0].length - 3,
        to: lineStart + inlineMatch.index + inlineMatch[0].length,
        decoration: markerDecoration
      });
    }
    lineOffset = lineEnd + 1;
  }
  decorations.sort((a, b) => a.from - b.from || a.to - b.to);
  let lastEnd = -1;
  for (const dec of decorations) {
    if (dec.from >= lastEnd && dec.from >= 0 && dec.to > dec.from && dec.to <= text.length) {
      builder.add(dec.from, dec.to, dec.decoration);
      lastEnd = dec.to;
    }
  }
  return builder.finish();
}
var decorationPlugin = import_view.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.decorations = buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = buildDecorations(update.view);
      }
    }
  },
  {
    decorations: (v) => v.decorations
  }
);
var decorationTheme = import_view.EditorView.baseTheme({
  ".ccs-syntax-marker": {
    color: "var(--text-faint)",
    fontFamily: "var(--font-monospace)",
    fontSize: "0.9em"
  },
  ".ccs-class-name": {
    color: "var(--color-cyan)",
    fontFamily: "var(--font-monospace)",
    backgroundColor: "var(--background-modifier-code)",
    borderRadius: "3px",
    padding: "0 3px"
  },
  ".ccs-escaped": {
    color: "var(--text-muted)",
    opacity: "0.6"
  }
});
function createEditorExtension() {
  return [decorationPlugin, decorationTheme];
}

// src/parser.ts
function parseClasses(classString) {
  if (!classString) return [];
  return classString.split(":").map((c) => c.trim().replace(/^\./, "")).filter((c) => c.length > 0 && isValidClassName(c));
}
function isValidClassName(name) {
  return /^[a-zA-Z_-][a-zA-Z0-9_-]*$/.test(name);
}
function isEscapedAt2(text, position) {
  if (position <= 0) return false;
  let backslashCount = 0;
  let i = position - 1;
  while (i >= 0 && text[i] === "\\") {
    backslashCount++;
    i--;
  }
  return backslashCount % 2 === 1;
}
function findUnescapedMarker(text, startFrom = 0) {
  let pos = startFrom;
  while (pos < text.length) {
    const idx = text.indexOf(":::", pos);
    if (idx === -1) return -1;
    if (!isEscapedAt2(text, idx)) {
      return idx;
    }
    pos = idx + 3;
  }
  return -1;
}
function parseSource(text) {
  const lines = text.split("\n");
  const lineInfo = /* @__PURE__ */ new Map();
  const blocks = [];
  const codeBlockLines = /* @__PURE__ */ new Set();
  let inCodeBlock = false;
  let codeBlockStartLine = -1;
  let currentBlock = null;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    const trimmedLine = line.trim();
    if (trimmedLine.startsWith("```")) {
      if (!inCodeBlock) {
        inCodeBlock = true;
        codeBlockStartLine = i;
        const markerPos = findUnescapedMarker(trimmedLine);
        if (markerPos !== -1) {
          const afterMarker = trimmedLine.slice(markerPos + 3).trim();
          const classes = parseClasses(afterMarker);
          if (classes.length > 0) {
            lineInfo.set(i, { type: "code-block", classes });
          }
        }
      } else {
        inCodeBlock = false;
        for (let j = codeBlockStartLine; j <= i; j++) {
          codeBlockLines.add(j);
        }
      }
      continue;
    }
    if (inCodeBlock) continue;
    if (/^:::\s*$/.test(trimmedLine) && currentBlock) {
      blocks.push({
        startLine: currentBlock.startLine,
        endLine: i,
        classes: currentBlock.classes,
        type: currentBlock.type
      });
      lineInfo.set(i, { type: "block-end", classes: currentBlock.classes });
      currentBlock = null;
      continue;
    }
    const blockStartMatch = trimmedLine.match(/^:::\s*([\w-]+(?:\s*:\s*[\w-]+)*)\s*$/);
    if (blockStartMatch && !currentBlock) {
      const classes = parseClasses(blockStartMatch[1]);
      if (classes.length > 0) {
        let blockType = "general";
        for (let j = i + 1; j < lines.length; j++) {
          const nextLine = lines[j].trim();
          if (!nextLine) continue;
          if (nextLine.startsWith("|")) {
            blockType = "table";
            break;
          }
          if (/^[-*+]\s/.test(nextLine) || /^\d+\.\s/.test(nextLine)) {
            blockType = "list";
            break;
          }
          if (nextLine.startsWith(":::")) break;
          break;
        }
        currentBlock = { startLine: i, classes, type: blockType };
        lineInfo.set(i, { type: "block-start", classes });
      }
      continue;
    }
    if (currentBlock) {
      lineInfo.set(i, { type: "block-content", classes: currentBlock.classes });
      continue;
    }
    const headerMatch = trimmedLine.match(/^(#{1,6})\s+(.+?)\s+:::\s*([\w-]+(?:\s*:\s*[\w-]+)*)\s*$/);
    if (headerMatch && findUnescapedMarker(trimmedLine) !== -1) {
      const classes = parseClasses(headerMatch[3]);
      if (classes.length > 0) {
        lineInfo.set(i, { type: "header", classes, contentWithoutMarker: headerMatch[2].trim() });
      }
      continue;
    }
    const calloutMatch = trimmedLine.match(/^>\s*\[!(\w+)\](.*?)\s*:::\s*([\w-]+(?:\s*:\s*[\w-]+)*)\s*$/);
    if (calloutMatch && findUnescapedMarker(trimmedLine) !== -1) {
      const classes = parseClasses(calloutMatch[3]);
      if (classes.length > 0) {
        lineInfo.set(i, { type: "callout", classes, contentWithoutMarker: calloutMatch[2].trim() });
      }
      continue;
    }
  }
  return { lineInfo, blocks, codeBlockLines };
}
function parseInlineText(text) {
  const matches = [];
  const regex = /:::(.+?):::/g;
  let match;
  while ((match = regex.exec(text)) !== null) {
    if (isEscapedAt2(text, match.index)) continue;
    const closePos = match.index + match[0].length - 3;
    if (isEscapedAt2(text, closePos)) continue;
    const inner = match[1].trim();
    const lastColonIndex = inner.lastIndexOf(":");
    if (lastColonIndex === -1) continue;
    const classesStr = inner.slice(0, lastColonIndex).trim();
    const content = inner.slice(lastColonIndex + 1).trim();
    if (!content || !classesStr) continue;
    const classes = parseClasses(classesStr);
    if (classes.length > 0) {
      matches.push({ start: match.index, end: match.index + match[0].length, classes, content });
    }
  }
  return matches;
}
function unescapeText(text) {
  return text.replace(/\\:::/g, ":::");
}

// src/postProcessor.ts
function getCleanText(el) {
  const clone = el.cloneNode(true);
  clone.querySelectorAll("svg, .collapse-indicator, .heading-collapse-indicator, .list-bullet, input, button").forEach((e) => e.remove());
  return clone.textContent || "";
}
function removeMarkerFromElement(el) {
  const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT);
  const textNodes = [];
  let node;
  while (node = walker.nextNode()) {
    textNodes.push(node);
  }
  for (const textNode of textNodes) {
    const text = textNode.textContent || "";
    const newText = text.replace(/\s*:::\s*[\w\s:.-]*$/, "").replace(/^\s*:::\s*$/, "");
    if (newText !== text) {
      textNode.textContent = newText;
    }
  }
  const brs = el.querySelectorAll("br");
  brs.forEach((br) => {
    var _a;
    const next = br.nextSibling;
    if ((next == null ? void 0 : next.nodeType) === Node.TEXT_NODE) {
      const nextText = ((_a = next.textContent) == null ? void 0 : _a.trim()) || "";
      if (nextText === ":::" || /^:::\s*$/.test(nextText)) {
        next.textContent = "";
      }
    }
  });
}
function extractClassesFromText(text) {
  const match = text.match(/:::\s*([\w-]+(?:\s*:\s*[\w-]+)*)\s*$/);
  if (match) {
    return parseClasses(match[1]);
  }
  return null;
}
var CustomClassPostProcessor = class {
  constructor(component) {
    this.component = component;
  }
  process(el, ctx) {
    const info = ctx.getSectionInfo(el);
    if (info) {
      const { text, lineStart, lineEnd } = info;
      const parseResult = parseSource(text);
      if (parseResult.codeBlockLines.has(lineStart)) {
        return;
      }
      this.processWithSource(el, lineStart, lineEnd, parseResult);
    }
    this.processHeadersDOM(el);
    this.processListItemsDOM(el);
    this.processCalloutsDOM(el);
    this.processInlineCodeDOM(el);
    this.processInlineText(el);
    this.cleanupBlockMarkers(el);
    this.unescapeMarkers(el);
  }
  processWithSource(el, lineStart, lineEnd, result) {
    const lineInfo = result.lineInfo.get(lineStart);
    for (const block of result.blocks) {
      if (lineStart >= block.startLine && lineEnd <= block.endLine) {
        this.applyBlockContentClasses(el, block, lineStart === block.startLine, lineEnd >= block.endLine);
        return;
      }
    }
    if (!lineInfo) return;
    switch (lineInfo.type) {
      case "header":
        this.processHeaderSource(el, lineInfo);
        break;
      case "callout":
        this.processCalloutSource(el, lineInfo);
        break;
      case "block-start":
        this.hideMarker(el);
        el.setAttribute("data-ccs-block-start", lineInfo.classes.join(" "));
        break;
      case "block-end":
        this.hideMarker(el);
        break;
    }
  }
  /**
   * DOM-based header processing (fallback for PDF export)
   */
  processHeadersDOM(el) {
    const headers = el.querySelectorAll("h1, h2, h3, h4, h5, h6");
    headers.forEach((header) => {
      if (header.hasAttribute("data-ccs-processed")) return;
      const text = getCleanText(header);
      const classes = extractClassesFromText(text);
      if (classes && classes.length > 0) {
        header.classList.add(...classes);
        header.setAttribute("data-ccs-processed", "true");
        removeMarkerFromElement(header);
      }
    });
  }
  /**
   * DOM-based list item processing
   */
  processListItemsDOM(el) {
    const listItems = el.querySelectorAll("li");
    listItems.forEach((li) => {
      if (li.hasAttribute("data-ccs-processed")) return;
      const text = getCleanText(li);
      const classes = extractClassesFromText(text);
      if (classes && classes.length > 0) {
        li.classList.add(...classes);
        li.setAttribute("data-ccs-processed", "true");
        removeMarkerFromElement(li);
      }
    });
  }
  /**
   * DOM-based callout processing
   */
  processCalloutsDOM(el) {
    const callouts = el.querySelectorAll(".callout");
    callouts.forEach((callout) => {
      if (callout.hasAttribute("data-ccs-processed")) return;
      const titleInner = callout.querySelector(".callout-title-inner");
      if (!titleInner) return;
      const text = titleInner.textContent || "";
      const classes = extractClassesFromText(text);
      if (classes && classes.length > 0) {
        callout.classList.add(...classes);
        callout.setAttribute("data-ccs-processed", "true");
        removeMarkerFromElement(titleInner);
      }
    });
  }
  /**
   * DOM-based inline code processing
   */
  processInlineCodeDOM(el) {
    const codeElements = el.querySelectorAll("code:not(pre code)");
    codeElements.forEach((code) => {
      if (code.hasAttribute("data-ccs-processed")) return;
      const nextSibling = code.nextSibling;
      if ((nextSibling == null ? void 0 : nextSibling.nodeType) !== Node.TEXT_NODE) return;
      const text = nextSibling.textContent || "";
      if (text.trimStart().startsWith("\\:::")) return;
      const match = text.match(/^\s*:::\s*([\w-]+(?:\s*:\s*[\w-]+)*)/);
      if (!match) return;
      const classes = parseClasses(match[1]);
      if (classes.length > 0) {
        code.classList.add(...classes);
        code.setAttribute("data-ccs-processed", "true");
        nextSibling.textContent = text.slice(match[0].length);
      }
    });
  }
  /**
   * Source-based header processing
   */
  processHeaderSource(el, info) {
    const header = el.querySelector("h1, h2, h3, h4, h5, h6");
    if (header && !header.hasAttribute("data-ccs-processed")) {
      header.classList.add(...info.classes);
      header.setAttribute("data-ccs-processed", "true");
      removeMarkerFromElement(header);
    }
  }
  /**
   * Source-based callout processing
   */
  processCalloutSource(el, info) {
    const callout = el.querySelector(".callout");
    if (callout && !callout.hasAttribute("data-ccs-processed")) {
      callout.classList.add(...info.classes);
      callout.setAttribute("data-ccs-processed", "true");
      const titleInner = callout.querySelector(".callout-title-inner");
      if (titleInner) {
        removeMarkerFromElement(titleInner);
      }
    }
  }
  hideMarker(el) {
    el.style.display = "none";
    el.classList.add("ccs-marker");
  }
  applyBlockContentClasses(el, block, isStart, containsEnd) {
    if (isStart) {
      this.hideMarker(el);
      el.setAttribute("data-ccs-block-start", block.classes.join(" "));
      return;
    }
    switch (block.type) {
      case "table":
        const table = el.querySelector("table");
        if (table) table.classList.add(...block.classes);
        break;
      case "list":
        const list = el.querySelector("ul, ol");
        if (list) list.classList.add(...block.classes);
        break;
      default:
        el.classList.add(...block.classes);
    }
    if (containsEnd) {
      this.removeBlockEndMarker(el);
    }
  }
  removeBlockEndMarker(el) {
    const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT);
    const textNodes = [];
    let node;
    while (node = walker.nextNode()) {
      textNodes.push(node);
    }
    for (let i = textNodes.length - 1; i >= 0; i--) {
      const textNode = textNodes[i];
      const text = textNode.textContent || "";
      if (/^\s*:::\s*$/.test(text)) {
        textNode.textContent = "";
        const prev = textNode.previousSibling;
        if ((prev == null ? void 0 : prev.nodeName) === "BR") prev.remove();
        break;
      }
      if (text.includes(":::")) {
        textNode.textContent = text.replace(/\s*:::\s*$/, "");
        break;
      }
    }
  }
  cleanupBlockMarkers(el) {
    if (el.classList.contains("ccs-marker")) return;
    const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT);
    const textNodes = [];
    let node;
    while (node = walker.nextNode()) {
      textNodes.push(node);
    }
    for (const textNode of textNodes) {
      const text = textNode.textContent || "";
      if (/^\s*:::\s*$/.test(text.trim())) {
        const parent = textNode.parentElement;
        if (parent && !parent.closest(".ccs-inline")) {
          textNode.textContent = "";
          const prev = textNode.previousSibling;
          if ((prev == null ? void 0 : prev.nodeName) === "BR") prev.remove();
        }
      }
    }
  }
  processInlineText(el) {
    if (el.classList.contains("ccs-marker")) return;
    const walker = document.createTreeWalker(
      el,
      NodeFilter.SHOW_TEXT,
      {
        acceptNode: (node2) => {
          const text = node2.textContent || "";
          const parent = node2.parentElement;
          if (!text.includes(":::")) return NodeFilter.FILTER_SKIP;
          if (parent == null ? void 0 : parent.closest(".ccs-inline, .ccs-marker, code, pre, svg")) {
            return NodeFilter.FILTER_SKIP;
          }
          return NodeFilter.FILTER_ACCEPT;
        }
      }
    );
    const textNodes = [];
    let node;
    while (node = walker.nextNode()) {
      textNodes.push(node);
    }
    for (const textNode of textNodes) {
      const text = textNode.textContent || "";
      const matches = parseInlineText(text);
      if (matches.length === 0) continue;
      const parent = textNode.parentNode;
      if (!parent) continue;
      const fragment = document.createDocumentFragment();
      let lastIndex = 0;
      for (const match of matches) {
        if (match.start > lastIndex) {
          fragment.appendChild(document.createTextNode(text.slice(lastIndex, match.start)));
        }
        const span = document.createElement("span");
        span.className = ["ccs-inline", ...match.classes].join(" ");
        span.textContent = match.content;
        fragment.appendChild(span);
        lastIndex = match.end;
      }
      if (lastIndex < text.length) {
        fragment.appendChild(document.createTextNode(text.slice(lastIndex)));
      }
      parent.replaceChild(fragment, textNode);
    }
  }
  unescapeMarkers(el) {
    var _a;
    const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT);
    const nodesToClean = [];
    let node;
    while (node = walker.nextNode()) {
      if ((_a = node.textContent) == null ? void 0 : _a.includes("\\:::")) {
        nodesToClean.push(node);
      }
    }
    nodesToClean.forEach((textNode) => {
      textNode.textContent = unescapeText(textNode.textContent || "");
    });
  }
};
function createPostProcessor(component) {
  const processor = new CustomClassPostProcessor(component);
  return (el, ctx) => {
    processor.process(el, ctx);
  };
}

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  enableLivePreview: true,
  enableReadingView: true,
  showClassLabels: false,
  includeSnippetsInPdf: true,
  customCSS: ""
};
var CustomClassSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Custom Class Syntax Settings" });
    containerEl.createEl("h3", { text: "Syntax" });
    const syntaxRef = containerEl.createDiv();
    syntaxRef.innerHTML = `
      <div style="background: var(--background-secondary); padding: 1em; border-radius: 6px; font-size: 0.85em; font-family: var(--font-monospace);">
        <div># Header ::: class</div>
        <div>- List item ::: class</div>
        <div>- [ ] Task ::: class</div>
        <div>> [!note] Title ::: class</div>
        <div>\`code\` ::: class</div>
        <div>::: class</div>
        <div>&nbsp;&nbsp;block content</div>
        <div>:::</div>
        <div>::: class : inline text :::</div>
        <div>\\::: escaped :::</div>
      </div>
    `;
    containerEl.createEl("h3", { text: "General" });
    new import_obsidian.Setting(containerEl).setName("Enable in Live Preview").setDesc("Show syntax highlighting in editor").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.enableLivePreview).onChange(async (value) => {
        this.plugin.settings.enableLivePreview = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show Class Labels").setDesc("Show class names above block elements").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.showClassLabels).onChange(async (value) => {
        this.plugin.settings.showClassLabels = value;
        await this.plugin.saveSettings();
        this.plugin.updateStyles();
      })
    );
    containerEl.createEl("h3", { text: "PDF Export" });
    new import_obsidian.Setting(containerEl).setName("Include CSS Snippets in PDF").setDesc("Embed enabled CSS snippets when exporting to PDF").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.includeSnippetsInPdf).onChange(async (value) => {
        this.plugin.settings.includeSnippetsInPdf = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Refresh Snippets Cache").setDesc("Manually reload CSS snippets from DOM").addButton(
      (button) => button.setButtonText("Refresh").onClick(() => {
        this.plugin.refreshSnippets();
        new import_obsidian.Notice("Snippets cache refreshed");
        this.display();
      })
    );
    const snippetsCSS = this.plugin.getSnippetsCSS();
    const infoDiv = containerEl.createDiv();
    infoDiv.style.cssText = "padding: 0.5em; background: var(--background-secondary); border-radius: 4px; font-size: 0.85em;";
    if (snippetsCSS) {
      const lines = snippetsCSS.split("\n").length;
      infoDiv.innerHTML = `<span style="color: var(--text-success);">\u2713</span> Cached ${lines} lines of CSS from snippets`;
    } else {
      infoDiv.innerHTML = `<span style="color: var(--text-muted);">No snippets cached. Make sure snippets are enabled in Appearance settings.</span>`;
    }
    containerEl.createEl("h3", { text: "Custom CSS" });
    new import_obsidian.Setting(containerEl).setName("Additional CSS").setDesc("Custom CSS (also included in PDF export)").addTextArea((text) => {
      text.setPlaceholder(".my-class {\n  color: red;\n}").setValue(this.plugin.settings.customCSS).onChange(async (value) => {
        this.plugin.settings.customCSS = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.rows = 10;
      text.inputEl.style.width = "100%";
      text.inputEl.style.fontFamily = "var(--font-monospace)";
    });
  }
};

// src/main.ts
var CustomClassPlugin = class extends import_obsidian2.Plugin {
  constructor() {
    super(...arguments);
    this.styleEl = null;
    this.snippetsCSSCache = "";
  }
  async onload() {
    console.log("Loading Custom Class Syntax plugin");
    await this.loadSettings();
    this.addSettingTab(new CustomClassSettingTab(this.app, this));
    this.registerMarkdownPostProcessor(createPostProcessor(this));
    if (this.settings.enableLivePreview) {
      this.registerEditorExtension(this.getEditorExtensions());
    }
    this.injectStyles();
    this.cacheSnippetsFromDOM();
    this.registerEvent(
      this.app.workspace.on("css-change", () => {
        this.cacheSnippetsFromDOM();
      })
    );
    this.registerMarkdownPostProcessor((el, ctx) => {
      this.injectPDFStyles(el);
    }, 1e3);
  }
  onunload() {
    console.log("Unloading Custom Class Syntax plugin");
    this.removeStyles();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getEditorExtensions() {
    return [createEditorExtension()];
  }
  injectStyles() {
    this.styleEl = document.createElement("style");
    this.styleEl.id = "ccs-plugin-base-styles";
    this.updateBaseStyles();
    document.head.appendChild(this.styleEl);
  }
  updateBaseStyles() {
    if (!this.styleEl) return;
    let css = `.ccs-marker { display: none !important; }`;
    if (this.settings.showClassLabels) {
      css += `
        .ccs-block { position: relative; }
        .ccs-block::before {
          content: attr(data-classes);
          position: absolute;
          top: -0.6em;
          left: 1em;
          font-size: 0.75em;
          padding: 0 0.5em;
          background: var(--background-primary);
          color: var(--text-muted);
          border-radius: 3px;
        }
      `;
    }
    this.styleEl.textContent = css;
  }
  /**
   * Cache CSS snippets from DOM
   * Obsidian loads snippets as <style> elements with various ID patterns
   */
  cacheSnippetsFromDOM() {
    const cssBlocks = [];
    const patterns = [
      'style[id^="snippet-"]',
      'style[id^="snippet:"]',
      "style[data-snippet]"
    ];
    patterns.forEach((pattern) => {
      document.querySelectorAll(pattern).forEach((styleEl) => {
        const css = styleEl.textContent || "";
        if (css.trim()) {
          cssBlocks.push(`/* ${styleEl.id || "snippet"} */
${css}`);
        }
      });
    });
    try {
      const customCss = this.app.customCss;
      if (customCss == null ? void 0 : customCss.csscache) {
        const enabledSnippets = Array.from(customCss.enabledSnippets || []);
        for (const [key, value] of Object.entries(customCss.csscache)) {
          if (typeof value === "string" && enabledSnippets.some((s) => key.includes(s))) {
            if (!cssBlocks.some((b) => b.includes(value.slice(0, 50)))) {
              cssBlocks.push(`/* ${key} */
${value}`);
            }
          }
        }
      }
    } catch (e) {
      console.debug("CCS: Could not access app.customCss", e);
    }
    this.snippetsCSSCache = cssBlocks.join("\n\n");
    console.log(`CCS: Cached ${cssBlocks.length} snippet blocks (${this.snippetsCSSCache.length} chars)`);
  }
  /**
   * Inject styles for PDF export
   */
  injectPDFStyles(el) {
    const container = el.closest(".markdown-preview-view, .markdown-rendered, .markdown-preview-sizer, .print");
    if (!container) return;
    if (container.querySelector("#ccs-pdf-export-styles")) return;
    let css = `/* CCS Export Styles */
.ccs-marker { display: none !important; }
`;
    if (this.settings.includeSnippetsInPdf && this.snippetsCSSCache) {
      css += `
/* === CSS Snippets === */
${this.snippetsCSSCache}
`;
    }
    if (this.settings.customCSS) {
      css += `
/* === Custom CSS === */
${this.settings.customCSS}
`;
    }
    css += `
@media print {
  .ccs-marker { display: none !important; }
  .ccs-block { break-inside: avoid; page-break-inside: avoid; }
}
`;
    const styleEl = document.createElement("style");
    styleEl.id = "ccs-pdf-export-styles";
    styleEl.textContent = css;
    container.insertBefore(styleEl, container.firstChild);
  }
  getSnippetsCSS() {
    return this.snippetsCSSCache;
  }
  refreshSnippets() {
    this.cacheSnippetsFromDOM();
  }
  updateStyles() {
    this.updateBaseStyles();
  }
  removeStyles() {
    var _a;
    (_a = this.styleEl) == null ? void 0 : _a.remove();
    this.styleEl = null;
    document.querySelectorAll("#ccs-pdf-export-styles").forEach((el) => el.remove());
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2VkaXRvckV4dGVuc2lvbi50cyIsICJzcmMvcGFyc2VyLnRzIiwgInNyYy9wb3N0UHJvY2Vzc29yLnRzIiwgInNyYy9zZXR0aW5ncy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyoqXHJcbiAqIEN1c3RvbSBDbGFzcyBTeW50YXggUGx1Z2luIGZvciBPYnNpZGlhblxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRXh0ZW5zaW9uIH0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xyXG5pbXBvcnQgeyBjcmVhdGVFZGl0b3JFeHRlbnNpb24gfSBmcm9tICcuL2VkaXRvckV4dGVuc2lvbic7XHJcbmltcG9ydCB7IGNyZWF0ZVBvc3RQcm9jZXNzb3IgfSBmcm9tICcuL3Bvc3RQcm9jZXNzb3InO1xyXG5pbXBvcnQge1xyXG4gIEN1c3RvbUNsYXNzU2V0dGluZ3MsXHJcbiAgREVGQVVMVF9TRVRUSU5HUyxcclxuICBDdXN0b21DbGFzc1NldHRpbmdUYWIsXHJcbn0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdXN0b21DbGFzc1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgc2V0dGluZ3M6IEN1c3RvbUNsYXNzU2V0dGluZ3M7XHJcbiAgcHJpdmF0ZSBzdHlsZUVsOiBIVE1MU3R5bGVFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBzbmlwcGV0c0NTU0NhY2hlOiBzdHJpbmcgPSAnJztcclxuXHJcbiAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgY29uc29sZS5sb2coJ0xvYWRpbmcgQ3VzdG9tIENsYXNzIFN5bnRheCBwbHVnaW4nKTtcclxuXHJcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQ3VzdG9tQ2xhc3NTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgcG9zdCBwcm9jZXNzb3JcclxuICAgIHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoY3JlYXRlUG9zdFByb2Nlc3Nvcih0aGlzKSk7XHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgZWRpdG9yIGV4dGVuc2lvblxyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlTGl2ZVByZXZpZXcpIHtcclxuICAgICAgdGhpcy5yZWdpc3RlckVkaXRvckV4dGVuc2lvbih0aGlzLmdldEVkaXRvckV4dGVuc2lvbnMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5qZWN0IGJhc2Ugc3R5bGVzXHJcbiAgICB0aGlzLmluamVjdFN0eWxlcygpO1xyXG5cclxuICAgIC8vIENhY2hlIHNuaXBwZXRzXHJcbiAgICB0aGlzLmNhY2hlU25pcHBldHNGcm9tRE9NKCk7XHJcblxyXG4gICAgLy8gUmUtY2FjaGUgd2hlbiBDU1MgY2hhbmdlc1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2Nzcy1jaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jYWNoZVNuaXBwZXRzRnJvbURPTSgpO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBJbmplY3QgQ1NTIGZvciBQREYgZXhwb3J0XHJcbiAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XHJcbiAgICAgIHRoaXMuaW5qZWN0UERGU3R5bGVzKGVsKTtcclxuICAgIH0sIDEwMDApO1xyXG4gIH1cclxuXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnVW5sb2FkaW5nIEN1c3RvbSBDbGFzcyBTeW50YXggcGx1Z2luJyk7XHJcbiAgICB0aGlzLnJlbW92ZVN0eWxlcygpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRFZGl0b3JFeHRlbnNpb25zKCk6IEV4dGVuc2lvbltdIHtcclxuICAgIHJldHVybiBbY3JlYXRlRWRpdG9yRXh0ZW5zaW9uKCldO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpbmplY3RTdHlsZXMoKSB7XHJcbiAgICB0aGlzLnN0eWxlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xyXG4gICAgdGhpcy5zdHlsZUVsLmlkID0gJ2Njcy1wbHVnaW4tYmFzZS1zdHlsZXMnO1xyXG4gICAgdGhpcy51cGRhdGVCYXNlU3R5bGVzKCk7XHJcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHRoaXMuc3R5bGVFbCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUJhc2VTdHlsZXMoKSB7XHJcbiAgICBpZiAoIXRoaXMuc3R5bGVFbCkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBsZXQgY3NzID0gYC5jY3MtbWFya2VyIHsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9YDtcclxuICAgIFxyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3Muc2hvd0NsYXNzTGFiZWxzKSB7XHJcbiAgICAgIGNzcyArPSBgXHJcbiAgICAgICAgLmNjcy1ibG9jayB7IHBvc2l0aW9uOiByZWxhdGl2ZTsgfVxyXG4gICAgICAgIC5jY3MtYmxvY2s6OmJlZm9yZSB7XHJcbiAgICAgICAgICBjb250ZW50OiBhdHRyKGRhdGEtY2xhc3Nlcyk7XHJcbiAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICB0b3A6IC0wLjZlbTtcclxuICAgICAgICAgIGxlZnQ6IDFlbTtcclxuICAgICAgICAgIGZvbnQtc2l6ZTogMC43NWVtO1xyXG4gICAgICAgICAgcGFkZGluZzogMCAwLjVlbTtcclxuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XHJcbiAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XHJcbiAgICAgICAgICBib3JkZXItcmFkaXVzOiAzcHg7XHJcbiAgICAgICAgfVxyXG4gICAgICBgO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLnN0eWxlRWwudGV4dENvbnRlbnQgPSBjc3M7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWNoZSBDU1Mgc25pcHBldHMgZnJvbSBET01cclxuICAgKiBPYnNpZGlhbiBsb2FkcyBzbmlwcGV0cyBhcyA8c3R5bGU+IGVsZW1lbnRzIHdpdGggdmFyaW91cyBJRCBwYXR0ZXJuc1xyXG4gICAqL1xyXG4gIGNhY2hlU25pcHBldHNGcm9tRE9NKCkge1xyXG4gICAgY29uc3QgY3NzQmxvY2tzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgbXVsdGlwbGUgcGF0dGVybnMgT2JzaWRpYW4gbWlnaHQgdXNlXHJcbiAgICBjb25zdCBwYXR0ZXJucyA9IFtcclxuICAgICAgJ3N0eWxlW2lkXj1cInNuaXBwZXQtXCJdJyxcclxuICAgICAgJ3N0eWxlW2lkXj1cInNuaXBwZXQ6XCJdJyxcclxuICAgICAgJ3N0eWxlW2RhdGEtc25pcHBldF0nLFxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgcGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChwYXR0ZXJuKS5mb3JFYWNoKHN0eWxlRWwgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNzcyA9IHN0eWxlRWwudGV4dENvbnRlbnQgfHwgJyc7XHJcbiAgICAgICAgaWYgKGNzcy50cmltKCkpIHtcclxuICAgICAgICAgIGNzc0Jsb2Nrcy5wdXNoKGAvKiAke3N0eWxlRWwuaWQgfHwgJ3NuaXBwZXQnfSAqL1xcbiR7Y3NzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gQWxzbyB0cnkgdG8gZ2V0IGZyb20gYXBwLmN1c3RvbUNzcyBpZiBhdmFpbGFibGVcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgY29uc3QgY3VzdG9tQ3NzID0gdGhpcy5hcHAuY3VzdG9tQ3NzO1xyXG4gICAgICBpZiAoY3VzdG9tQ3NzPy5jc3NjYWNoZSkge1xyXG4gICAgICAgIGNvbnN0IGVuYWJsZWRTbmlwcGV0cyA9IEFycmF5LmZyb20oY3VzdG9tQ3NzLmVuYWJsZWRTbmlwcGV0cyB8fCBbXSkgYXMgc3RyaW5nW107XHJcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoY3VzdG9tQ3NzLmNzc2NhY2hlKSkge1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgZW5hYmxlZFNuaXBwZXRzLnNvbWUocyA9PiBrZXkuaW5jbHVkZXMocykpKSB7XHJcbiAgICAgICAgICAgIGlmICghY3NzQmxvY2tzLnNvbWUoYiA9PiBiLmluY2x1ZGVzKHZhbHVlLnNsaWNlKDAsIDUwKSkpKSB7XHJcbiAgICAgICAgICAgICAgY3NzQmxvY2tzLnB1c2goYC8qICR7a2V5fSAqL1xcbiR7dmFsdWV9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5kZWJ1ZygnQ0NTOiBDb3VsZCBub3QgYWNjZXNzIGFwcC5jdXN0b21Dc3MnLCBlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdGhpcy5zbmlwcGV0c0NTU0NhY2hlID0gY3NzQmxvY2tzLmpvaW4oJ1xcblxcbicpO1xyXG4gICAgY29uc29sZS5sb2coYENDUzogQ2FjaGVkICR7Y3NzQmxvY2tzLmxlbmd0aH0gc25pcHBldCBibG9ja3MgKCR7dGhpcy5zbmlwcGV0c0NTU0NhY2hlLmxlbmd0aH0gY2hhcnMpYCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmplY3Qgc3R5bGVzIGZvciBQREYgZXhwb3J0XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbmplY3RQREZTdHlsZXMoZWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBlbC5jbG9zZXN0KCcubWFya2Rvd24tcHJldmlldy12aWV3LCAubWFya2Rvd24tcmVuZGVyZWQsIC5tYXJrZG93bi1wcmV2aWV3LXNpemVyLCAucHJpbnQnKTtcclxuICAgIGlmICghY29udGFpbmVyKSByZXR1cm47XHJcbiAgICBcclxuICAgIGlmIChjb250YWluZXIucXVlcnlTZWxlY3RvcignI2Njcy1wZGYtZXhwb3J0LXN0eWxlcycpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGxldCBjc3MgPSBgLyogQ0NTIEV4cG9ydCBTdHlsZXMgKi9cXG4uY2NzLW1hcmtlciB7IGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsgfVxcbmA7XHJcbiAgICBcclxuICAgIGlmICh0aGlzLnNldHRpbmdzLmluY2x1ZGVTbmlwcGV0c0luUGRmICYmIHRoaXMuc25pcHBldHNDU1NDYWNoZSkge1xyXG4gICAgICBjc3MgKz0gYFxcbi8qID09PSBDU1MgU25pcHBldHMgPT09ICovXFxuJHt0aGlzLnNuaXBwZXRzQ1NTQ2FjaGV9XFxuYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuY3VzdG9tQ1NTKSB7XHJcbiAgICAgIGNzcyArPSBgXFxuLyogPT09IEN1c3RvbSBDU1MgPT09ICovXFxuJHt0aGlzLnNldHRpbmdzLmN1c3RvbUNTU31cXG5gO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjc3MgKz0gYFxyXG5AbWVkaWEgcHJpbnQge1xyXG4gIC5jY3MtbWFya2VyIHsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9XHJcbiAgLmNjcy1ibG9jayB7IGJyZWFrLWluc2lkZTogYXZvaWQ7IHBhZ2UtYnJlYWstaW5zaWRlOiBhdm9pZDsgfVxyXG59XHJcbmA7XHJcbiAgICBcclxuICAgIGNvbnN0IHN0eWxlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xyXG4gICAgc3R5bGVFbC5pZCA9ICdjY3MtcGRmLWV4cG9ydC1zdHlsZXMnO1xyXG4gICAgc3R5bGVFbC50ZXh0Q29udGVudCA9IGNzcztcclxuICAgIGNvbnRhaW5lci5pbnNlcnRCZWZvcmUoc3R5bGVFbCwgY29udGFpbmVyLmZpcnN0Q2hpbGQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0U25pcHBldHNDU1MoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLnNuaXBwZXRzQ1NTQ2FjaGU7XHJcbiAgfVxyXG5cclxuICByZWZyZXNoU25pcHBldHMoKSB7XHJcbiAgICB0aGlzLmNhY2hlU25pcHBldHNGcm9tRE9NKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVTdHlsZXMoKSB7XHJcbiAgICB0aGlzLnVwZGF0ZUJhc2VTdHlsZXMoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVtb3ZlU3R5bGVzKCkge1xyXG4gICAgdGhpcy5zdHlsZUVsPy5yZW1vdmUoKTtcclxuICAgIHRoaXMuc3R5bGVFbCA9IG51bGw7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjY2NzLXBkZi1leHBvcnQtc3R5bGVzJykuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmUoKSk7XHJcbiAgfVxyXG59IiwgIi8qKlxyXG4gKiBDb2RlTWlycm9yIDYgRXh0ZW5zaW9uIGZvciBMaXZlIFByZXZpZXdcclxuICogVXBkYXRlZCBmb3IgbmV3IHN5bnRheCBwYXR0ZXJuc1xyXG4gKi9cclxuXHJcbmltcG9ydCB7XHJcbiAgRWRpdG9yVmlldyxcclxuICBEZWNvcmF0aW9uLFxyXG4gIERlY29yYXRpb25TZXQsXHJcbiAgVmlld1BsdWdpbixcclxuICBWaWV3VXBkYXRlLFxyXG59IGZyb20gJ0Bjb2RlbWlycm9yL3ZpZXcnO1xyXG5pbXBvcnQgeyBSYW5nZVNldEJ1aWxkZXIsIEV4dGVuc2lvbiB9IGZyb20gJ0Bjb2RlbWlycm9yL3N0YXRlJztcclxuXHJcbi8vIFBhdHRlcm5zIGZvciBzeW50YXggaGlnaGxpZ2h0aW5nIGluIGVkaXRvclxyXG5jb25zdCBQQVRURVJOUyA9IHtcclxuICAvLyAjIEhlYWRlciA6OjogY2xhc3NcclxuICBIRUFERVI6IC9eKCN7MSw2fSlcXHMrKC4rPylcXHMrKDo6OlxccypbXFx3LV0rKD86XFxzKjpcXHMqW1xcdy1dKykqKVxccyokLyxcclxuICBcclxuICAvLyAtIGl0ZW0gOjo6IGNsYXNzIG9yIC0gWyBdIGl0ZW0gOjo6IGNsYXNzXHJcbiAgTElTVF9JVEVNOiAvXihcXHMqWy0qK10pXFxzKyg/OlxcW1sgeFhdXFxdXFxzKyk/KC4rPylcXHMrKDo6OlxccypbXFx3LV0rKD86XFxzKjpcXHMqW1xcdy1dKykqKVxccyokLyxcclxuICBcclxuICAvLyA+IFshdHlwZV0gVGl0bGUgOjo6IGNsYXNzXHJcbiAgQ0FMTE9VVDogL14+XFxzKlxcWyFcXHcrXFxdKC4qPylcXHMrKDo6OlxccypbXFx3LV0rKD86XFxzKjpcXHMqW1xcdy1dKykqKVxccyokLyxcclxuICBcclxuICAvLyBgYGBsYW5nIDo6OiBjbGFzc1xyXG4gIENPREVfQkxPQ0s6IC9eYGBgKFxcdyopXFxzKiguKj8pXFxzKig6OjpcXHMqW1xcdy1dKyg/Olxccyo6XFxzKltcXHctXSspKilcXHMqJC8sXHJcbiAgXHJcbiAgLy8gOjo6IGNsYXNzIChibG9jayBzdGFydClcclxuICBCTE9DS19TVEFSVDogL146OjpcXHMqKFtcXHctXSsoPzpcXHMqOlxccypbXFx3LV0rKSopXFxzKiQvLFxyXG4gIFxyXG4gIC8vIDo6OiAoYmxvY2sgZW5kKVxyXG4gIEJMT0NLX0VORDogL146OjpcXHMqJC8sXHJcbn07XHJcblxyXG4vLyBEZWNvcmF0aW9uc1xyXG5jb25zdCBtYXJrZXJEZWNvcmF0aW9uID0gRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6ICdjY3Mtc3ludGF4LW1hcmtlcicgfSk7XHJcbmNvbnN0IGNsYXNzRGVjb3JhdGlvbiA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiAnY2NzLWNsYXNzLW5hbWUnIH0pO1xyXG5jb25zdCBlc2NhcGVkRGVjb3JhdGlvbiA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiAnY2NzLWVzY2FwZWQnIH0pO1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHBvc2l0aW9uIGlzIGVzY2FwZWRcclxuICovXHJcbmZ1bmN0aW9uIGlzRXNjYXBlZEF0KHRleHQ6IHN0cmluZywgcG9zaXRpb246IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gIGlmIChwb3NpdGlvbiA8PSAwKSByZXR1cm4gZmFsc2U7XHJcbiAgbGV0IGNvdW50ID0gMDtcclxuICBsZXQgaSA9IHBvc2l0aW9uIC0gMTtcclxuICB3aGlsZSAoaSA+PSAwICYmIHRleHRbaV0gPT09ICdcXFxcJykge1xyXG4gICAgY291bnQrKztcclxuICAgIGktLTtcclxuICB9XHJcbiAgcmV0dXJuIGNvdW50ICUgMiA9PT0gMTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEJ1aWxkIGRlY29yYXRpb25zIGZvciB0aGUgZWRpdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBidWlsZERlY29yYXRpb25zKHZpZXc6IEVkaXRvclZpZXcpOiBEZWNvcmF0aW9uU2V0IHtcclxuICBjb25zdCBidWlsZGVyID0gbmV3IFJhbmdlU2V0QnVpbGRlcjxEZWNvcmF0aW9uPigpO1xyXG4gIGNvbnN0IGRvYyA9IHZpZXcuc3RhdGUuZG9jO1xyXG4gIGNvbnN0IHRleHQgPSBkb2MudG9TdHJpbmcoKTtcclxuICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xyXG4gIFxyXG4gIGNvbnN0IGRlY29yYXRpb25zOiBBcnJheTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlcjsgZGVjb3JhdGlvbjogRGVjb3JhdGlvbiB9PiA9IFtdO1xyXG4gIFxyXG4gIGxldCBsaW5lT2Zmc2V0ID0gMDtcclxuICBsZXQgaW5Db2RlQmxvY2sgPSBmYWxzZTtcclxuICBcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XHJcbiAgICBjb25zdCBsaW5lU3RhcnQgPSBsaW5lT2Zmc2V0O1xyXG4gICAgY29uc3QgbGluZUVuZCA9IGxpbmVPZmZzZXQgKyBsaW5lLmxlbmd0aDtcclxuICAgIFxyXG4gICAgLy8gVHJhY2sgY29kZSBibG9ja3NcclxuICAgIGlmIChsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdgYGAnKSkge1xyXG4gICAgICBpZiAoIWluQ29kZUJsb2NrKSB7XHJcbiAgICAgICAgaW5Db2RlQmxvY2sgPSB0cnVlO1xyXG4gICAgICAgIC8vIENoZWNrIGZvciBjbGFzcyBvbiBjb2RlIGJsb2NrXHJcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKFBBVFRFUk5TLkNPREVfQkxPQ0spO1xyXG4gICAgICAgIGlmIChtYXRjaCkge1xyXG4gICAgICAgICAgY29uc3QgbWFya2VyU3RhcnQgPSBsaW5lLmxhc3RJbmRleE9mKCc6OjonKTtcclxuICAgICAgICAgIGlmIChtYXJrZXJTdGFydCAhPT0gLTEgJiYgIWlzRXNjYXBlZEF0KGxpbmUsIG1hcmtlclN0YXJ0KSkge1xyXG4gICAgICAgICAgICBkZWNvcmF0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgICBmcm9tOiBsaW5lU3RhcnQgKyBtYXJrZXJTdGFydCxcclxuICAgICAgICAgICAgICB0bzogbGluZVN0YXJ0ICsgbWFya2VyU3RhcnQgKyAzLFxyXG4gICAgICAgICAgICAgIGRlY29yYXRpb246IG1hcmtlckRlY29yYXRpb24sXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc1N0YXJ0ID0gbWFya2VyU3RhcnQgKyAzO1xyXG4gICAgICAgICAgICBjb25zdCBjbGFzc0VuZCA9IGxpbmUubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAoY2xhc3NFbmQgPiBjbGFzc1N0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgZGVjb3JhdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBmcm9tOiBsaW5lU3RhcnQgKyBjbGFzc1N0YXJ0LFxyXG4gICAgICAgICAgICAgICAgdG86IGxpbmVTdGFydCArIGNsYXNzRW5kLFxyXG4gICAgICAgICAgICAgICAgZGVjb3JhdGlvbjogY2xhc3NEZWNvcmF0aW9uLFxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGluQ29kZUJsb2NrID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgbGluZU9mZnNldCA9IGxpbmVFbmQgKyAxO1xyXG4gICAgICBjb250aW51ZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gU2tpcCBpbnNpZGUgY29kZSBibG9ja3NcclxuICAgIGlmIChpbkNvZGVCbG9jaykge1xyXG4gICAgICBsaW5lT2Zmc2V0ID0gbGluZUVuZCArIDE7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBmb3IgZXNjYXBlZCBcXDo6OlxyXG4gICAgY29uc3QgZXNjYXBlZE1hdGNoID0gbGluZS5tYXRjaCgvXFxcXDo6Oi9nKTtcclxuICAgIGlmIChlc2NhcGVkTWF0Y2gpIHtcclxuICAgICAgbGV0IHBvcyA9IDA7XHJcbiAgICAgIHdoaWxlIChwb3MgPCBsaW5lLmxlbmd0aCkge1xyXG4gICAgICAgIGNvbnN0IGlkeCA9IGxpbmUuaW5kZXhPZignXFxcXDo6OicsIHBvcyk7XHJcbiAgICAgICAgaWYgKGlkeCA9PT0gLTEpIGJyZWFrO1xyXG4gICAgICAgIGRlY29yYXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgZnJvbTogbGluZVN0YXJ0ICsgaWR4LFxyXG4gICAgICAgICAgdG86IGxpbmVTdGFydCArIGlkeCArIDQsXHJcbiAgICAgICAgICBkZWNvcmF0aW9uOiBlc2NhcGVkRGVjb3JhdGlvbixcclxuICAgICAgICB9KTtcclxuICAgICAgICBwb3MgPSBpZHggKyA0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIHZhcmlvdXMgcGF0dGVybnNcclxuICAgIGNvbnN0IHRyaW1tZWQgPSBsaW5lLnRyaW0oKTtcclxuICAgIFxyXG4gICAgLy8gQmxvY2sgc3RhcnQvZW5kXHJcbiAgICBpZiAoUEFUVEVSTlMuQkxPQ0tfU1RBUlQudGVzdCh0cmltbWVkKSkge1xyXG4gICAgICBjb25zdCBtYXJrZXJTdGFydCA9IGxpbmUuaW5kZXhPZignOjo6Jyk7XHJcbiAgICAgIGlmIChtYXJrZXJTdGFydCAhPT0gLTEgJiYgIWlzRXNjYXBlZEF0KGxpbmUsIG1hcmtlclN0YXJ0KSkge1xyXG4gICAgICAgIGRlY29yYXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgZnJvbTogbGluZVN0YXJ0ICsgbWFya2VyU3RhcnQsXHJcbiAgICAgICAgICB0bzogbGluZVN0YXJ0ICsgbWFya2VyU3RhcnQgKyAzLFxyXG4gICAgICAgICAgZGVjb3JhdGlvbjogbWFya2VyRGVjb3JhdGlvbixcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBhZnRlck1hcmtlciA9IG1hcmtlclN0YXJ0ICsgMztcclxuICAgICAgICBjb25zdCBjbGFzc0VuZCA9IGxpbmUudHJpbUVuZCgpLmxlbmd0aDtcclxuICAgICAgICBpZiAoY2xhc3NFbmQgPiBhZnRlck1hcmtlcikge1xyXG4gICAgICAgICAgZGVjb3JhdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgIGZyb206IGxpbmVTdGFydCArIGFmdGVyTWFya2VyLFxyXG4gICAgICAgICAgICB0bzogbGluZVN0YXJ0ICsgY2xhc3NFbmQsXHJcbiAgICAgICAgICAgIGRlY29yYXRpb246IGNsYXNzRGVjb3JhdGlvbixcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChQQVRURVJOUy5CTE9DS19FTkQudGVzdCh0cmltbWVkKSkge1xyXG4gICAgICBjb25zdCBtYXJrZXJTdGFydCA9IGxpbmUuaW5kZXhPZignOjo6Jyk7XHJcbiAgICAgIGlmIChtYXJrZXJTdGFydCAhPT0gLTEgJiYgIWlzRXNjYXBlZEF0KGxpbmUsIG1hcmtlclN0YXJ0KSkge1xyXG4gICAgICAgIGRlY29yYXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgZnJvbTogbGluZVN0YXJ0ICsgbWFya2VyU3RhcnQsXHJcbiAgICAgICAgICB0bzogbGluZVN0YXJ0ICsgbWFya2VyU3RhcnQgKyAzLFxyXG4gICAgICAgICAgZGVjb3JhdGlvbjogbWFya2VyRGVjb3JhdGlvbixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBIZWFkZXIsIGxpc3QgaXRlbSwgY2FsbG91dFxyXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIFtQQVRURVJOUy5IRUFERVIsIFBBVFRFUk5TLkxJU1RfSVRFTSwgUEFUVEVSTlMuQ0FMTE9VVF0pIHtcclxuICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKHBhdHRlcm4pO1xyXG4gICAgICBpZiAobWF0Y2gpIHtcclxuICAgICAgICAvLyBGaW5kIDo6OiBwb3NpdGlvblxyXG4gICAgICAgIGNvbnN0IG1hcmtlclN0YXJ0ID0gbGluZS5sYXN0SW5kZXhPZignOjo6Jyk7XHJcbiAgICAgICAgaWYgKG1hcmtlclN0YXJ0ICE9PSAtMSAmJiAhaXNFc2NhcGVkQXQobGluZSwgbWFya2VyU3RhcnQpKSB7XHJcbiAgICAgICAgICBkZWNvcmF0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgZnJvbTogbGluZVN0YXJ0ICsgbWFya2VyU3RhcnQsXHJcbiAgICAgICAgICAgIHRvOiBsaW5lU3RhcnQgKyBtYXJrZXJTdGFydCArIDMsXHJcbiAgICAgICAgICAgIGRlY29yYXRpb246IG1hcmtlckRlY29yYXRpb24sXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNvbnN0IGNsYXNzU3RhcnQgPSBtYXJrZXJTdGFydCArIDM7XHJcbiAgICAgICAgICBjb25zdCBjbGFzc0VuZCA9IGxpbmUudHJpbUVuZCgpLmxlbmd0aDtcclxuICAgICAgICAgIGlmIChjbGFzc0VuZCA+IGNsYXNzU3RhcnQpIHtcclxuICAgICAgICAgICAgZGVjb3JhdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgZnJvbTogbGluZVN0YXJ0ICsgY2xhc3NTdGFydCxcclxuICAgICAgICAgICAgICB0bzogbGluZVN0YXJ0ICsgY2xhc3NFbmQsXHJcbiAgICAgICAgICAgICAgZGVjb3JhdGlvbjogY2xhc3NEZWNvcmF0aW9uLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSW5saW5lOiBgY29kZWAgOjo6IGNsYXNzIGFuZCA6OjogY2xhc3MgOiBjb250ZW50IDo6OlxyXG4gICAgLy8gSW5saW5lIGNvZGVcclxuICAgIGNvbnN0IGlubGluZUNvZGVSZWdleCA9IC9gW15gXStgXFxzKjo6OlxccypbXFx3LV0rKD86XFxzKjpcXHMqW1xcdy1dKykqL2c7XHJcbiAgICBsZXQgaW5saW5lTWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSB8IG51bGw7XHJcbiAgICB3aGlsZSAoKGlubGluZU1hdGNoID0gaW5saW5lQ29kZVJlZ2V4LmV4ZWMobGluZSkpICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IG1hcmtlclBvcyA9IGlubGluZU1hdGNoWzBdLmluZGV4T2YoJzo6OicpO1xyXG4gICAgICBjb25zdCBnbG9iYWxQb3MgPSBpbmxpbmVNYXRjaC5pbmRleCArIG1hcmtlclBvcztcclxuICAgICAgaWYgKCFpc0VzY2FwZWRBdChsaW5lLCBnbG9iYWxQb3MpKSB7XHJcbiAgICAgICAgZGVjb3JhdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICBmcm9tOiBsaW5lU3RhcnQgKyBnbG9iYWxQb3MsXHJcbiAgICAgICAgICB0bzogbGluZVN0YXJ0ICsgaW5saW5lTWF0Y2guaW5kZXggKyBpbmxpbmVNYXRjaFswXS5sZW5ndGgsXHJcbiAgICAgICAgICBkZWNvcmF0aW9uOiBtYXJrZXJEZWNvcmF0aW9uLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElubGluZSB0ZXh0IDo6OiBjbGFzcyA6IGNvbnRlbnQgOjo6XHJcbiAgICBjb25zdCBpbmxpbmVUZXh0UmVnZXggPSAvOjo6KC4rPyk6OjovZztcclxuICAgIHdoaWxlICgoaW5saW5lTWF0Y2ggPSBpbmxpbmVUZXh0UmVnZXguZXhlYyhsaW5lKSkgIT09IG51bGwpIHtcclxuICAgICAgaWYgKGlzRXNjYXBlZEF0KGxpbmUsIGlubGluZU1hdGNoLmluZGV4KSkgY29udGludWU7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPcGVuaW5nIDo6OlxyXG4gICAgICBkZWNvcmF0aW9ucy5wdXNoKHtcclxuICAgICAgICBmcm9tOiBsaW5lU3RhcnQgKyBpbmxpbmVNYXRjaC5pbmRleCxcclxuICAgICAgICB0bzogbGluZVN0YXJ0ICsgaW5saW5lTWF0Y2guaW5kZXggKyAzLFxyXG4gICAgICAgIGRlY29yYXRpb246IG1hcmtlckRlY29yYXRpb24sXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gQ29udGVudCAoZmluZCBsYXN0IDogdG8gc2VwYXJhdGUgY2xhc3MgZnJvbSBjb250ZW50KVxyXG4gICAgICBjb25zdCBpbm5lciA9IGlubGluZU1hdGNoWzFdO1xyXG4gICAgICBjb25zdCBsYXN0Q29sb24gPSBpbm5lci5sYXN0SW5kZXhPZignOicpO1xyXG4gICAgICBpZiAobGFzdENvbG9uID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGNsYXNzRW5kID0gaW5saW5lTWF0Y2guaW5kZXggKyAzICsgbGFzdENvbG9uO1xyXG4gICAgICAgIGRlY29yYXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgZnJvbTogbGluZVN0YXJ0ICsgaW5saW5lTWF0Y2guaW5kZXggKyAzLFxyXG4gICAgICAgICAgdG86IGxpbmVTdGFydCArIGNsYXNzRW5kLFxyXG4gICAgICAgICAgZGVjb3JhdGlvbjogY2xhc3NEZWNvcmF0aW9uLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBDbG9zaW5nIDo6OlxyXG4gICAgICBkZWNvcmF0aW9ucy5wdXNoKHtcclxuICAgICAgICBmcm9tOiBsaW5lU3RhcnQgKyBpbmxpbmVNYXRjaC5pbmRleCArIGlubGluZU1hdGNoWzBdLmxlbmd0aCAtIDMsXHJcbiAgICAgICAgdG86IGxpbmVTdGFydCArIGlubGluZU1hdGNoLmluZGV4ICsgaW5saW5lTWF0Y2hbMF0ubGVuZ3RoLFxyXG4gICAgICAgIGRlY29yYXRpb246IG1hcmtlckRlY29yYXRpb24sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsaW5lT2Zmc2V0ID0gbGluZUVuZCArIDE7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNvcnQgYW5kIGZpbHRlciBvdmVybGFwcGluZ1xyXG4gIGRlY29yYXRpb25zLnNvcnQoKGEsIGIpID0+IGEuZnJvbSAtIGIuZnJvbSB8fCBhLnRvIC0gYi50byk7XHJcbiAgXHJcbiAgbGV0IGxhc3RFbmQgPSAtMTtcclxuICBmb3IgKGNvbnN0IGRlYyBvZiBkZWNvcmF0aW9ucykge1xyXG4gICAgaWYgKGRlYy5mcm9tID49IGxhc3RFbmQgJiYgZGVjLmZyb20gPj0gMCAmJiBkZWMudG8gPiBkZWMuZnJvbSAmJiBkZWMudG8gPD0gdGV4dC5sZW5ndGgpIHtcclxuICAgICAgYnVpbGRlci5hZGQoZGVjLmZyb20sIGRlYy50bywgZGVjLmRlY29yYXRpb24pO1xyXG4gICAgICBsYXN0RW5kID0gZGVjLnRvO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZpZXcgcGx1Z2luXHJcbiAqL1xyXG5jb25zdCBkZWNvcmF0aW9uUGx1Z2luID0gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXHJcbiAgY2xhc3Mge1xyXG4gICAgZGVjb3JhdGlvbnM6IERlY29yYXRpb25TZXQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xyXG4gICAgICB0aGlzLmRlY29yYXRpb25zID0gYnVpbGREZWNvcmF0aW9ucyh2aWV3KTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XHJcbiAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XHJcbiAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IGJ1aWxkRGVjb3JhdGlvbnModXBkYXRlLnZpZXcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICB7XHJcbiAgICBkZWNvcmF0aW9uczogKHYpID0+IHYuZGVjb3JhdGlvbnMsXHJcbiAgfVxyXG4pO1xyXG5cclxuLyoqXHJcbiAqIFRoZW1lXHJcbiAqL1xyXG5jb25zdCBkZWNvcmF0aW9uVGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7XHJcbiAgJy5jY3Mtc3ludGF4LW1hcmtlcic6IHtcclxuICAgIGNvbG9yOiAndmFyKC0tdGV4dC1mYWludCknLFxyXG4gICAgZm9udEZhbWlseTogJ3ZhcigtLWZvbnQtbW9ub3NwYWNlKScsXHJcbiAgICBmb250U2l6ZTogJzAuOWVtJyxcclxuICB9LFxyXG4gICcuY2NzLWNsYXNzLW5hbWUnOiB7XHJcbiAgICBjb2xvcjogJ3ZhcigtLWNvbG9yLWN5YW4pJyxcclxuICAgIGZvbnRGYW1pbHk6ICd2YXIoLS1mb250LW1vbm9zcGFjZSknLFxyXG4gICAgYmFja2dyb3VuZENvbG9yOiAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1jb2RlKScsXHJcbiAgICBib3JkZXJSYWRpdXM6ICczcHgnLFxyXG4gICAgcGFkZGluZzogJzAgM3B4JyxcclxuICB9LFxyXG4gICcuY2NzLWVzY2FwZWQnOiB7XHJcbiAgICBjb2xvcjogJ3ZhcigtLXRleHQtbXV0ZWQpJyxcclxuICAgIG9wYWNpdHk6ICcwLjYnLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEV4cG9ydCBleHRlbnNpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFZGl0b3JFeHRlbnNpb24oKTogRXh0ZW5zaW9uIHtcclxuICByZXR1cm4gW2RlY29yYXRpb25QbHVnaW4sIGRlY29yYXRpb25UaGVtZV07XHJcbn0iLCAiLyoqXHJcbiAqIFBhcnNlciBmb3IgY3VzdG9tIGNsYXNzIHN5bnRheFxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2xhc3NJbmZvIHtcclxuICB0eXBlOiBcclxuICAgIHwgJ2hlYWRlcicgXHJcbiAgICB8ICdsaXN0LWl0ZW0nIFxyXG4gICAgfCAnY2FsbG91dCcgXHJcbiAgICB8ICdjb2RlLWJsb2NrJyBcclxuICAgIHwgJ2NoZWNrYm94JyBcclxuICAgIHwgJ2Jsb2NrLXN0YXJ0JyBcclxuICAgIHwgJ2Jsb2NrLWVuZCcgXHJcbiAgICB8ICdibG9jay1jb250ZW50JztcclxuICBjbGFzc2VzOiBzdHJpbmdbXTtcclxuICBjb250ZW50V2l0aG91dE1hcmtlcj86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBCbG9ja0luZm8ge1xyXG4gIHN0YXJ0TGluZTogbnVtYmVyO1xyXG4gIGVuZExpbmU6IG51bWJlcjtcclxuICBjbGFzc2VzOiBzdHJpbmdbXTtcclxuICB0eXBlOiAndGFibGUnIHwgJ2xpc3QnIHwgJ2dlbmVyYWwnO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElubGluZVRleHRNYXRjaCB7XHJcbiAgc3RhcnQ6IG51bWJlcjtcclxuICBlbmQ6IG51bWJlcjtcclxuICBjbGFzc2VzOiBzdHJpbmdbXTtcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU291cmNlUGFyc2VSZXN1bHQge1xyXG4gIGxpbmVJbmZvOiBNYXA8bnVtYmVyLCBDbGFzc0luZm8+O1xyXG4gIGJsb2NrczogQmxvY2tJbmZvW107XHJcbiAgY29kZUJsb2NrTGluZXM6IFNldDxudW1iZXI+O1xyXG59XHJcblxyXG4vKipcclxuICogUGFyc2UgY2xhc3NlcyBmcm9tIHN0cmluZyBsaWtlIFwiY2xhc3MxIDogY2xhc3MyXCJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNsYXNzZXMoY2xhc3NTdHJpbmc6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICBpZiAoIWNsYXNzU3RyaW5nKSByZXR1cm4gW107XHJcbiAgcmV0dXJuIGNsYXNzU3RyaW5nXHJcbiAgICAuc3BsaXQoJzonKVxyXG4gICAgLm1hcChjID0+IGMudHJpbSgpLnJlcGxhY2UoL15cXC4vLCAnJykpXHJcbiAgICAuZmlsdGVyKGMgPT4gYy5sZW5ndGggPiAwICYmIGlzVmFsaWRDbGFzc05hbWUoYykpO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgQ1NTIGNsYXNzIG5hbWVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkQ2xhc3NOYW1lKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiAvXlthLXpBLVpfLV1bYS16QS1aMC05Xy1dKiQvLnRlc3QobmFtZSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBwb3NpdGlvbiBpcyBlc2NhcGVkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNFc2NhcGVkQXQodGV4dDogc3RyaW5nLCBwb3NpdGlvbjogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgaWYgKHBvc2l0aW9uIDw9IDApIHJldHVybiBmYWxzZTtcclxuICBsZXQgYmFja3NsYXNoQ291bnQgPSAwO1xyXG4gIGxldCBpID0gcG9zaXRpb24gLSAxO1xyXG4gIHdoaWxlIChpID49IDAgJiYgdGV4dFtpXSA9PT0gJ1xcXFwnKSB7XHJcbiAgICBiYWNrc2xhc2hDb3VudCsrO1xyXG4gICAgaS0tO1xyXG4gIH1cclxuICByZXR1cm4gYmFja3NsYXNoQ291bnQgJSAyID09PSAxO1xyXG59XHJcblxyXG4vKipcclxuICogRmluZCB1bmVzY2FwZWQgOjo6IGluIHRleHRcclxuICovXHJcbmZ1bmN0aW9uIGZpbmRVbmVzY2FwZWRNYXJrZXIodGV4dDogc3RyaW5nLCBzdGFydEZyb206IG51bWJlciA9IDApOiBudW1iZXIge1xyXG4gIGxldCBwb3MgPSBzdGFydEZyb207XHJcbiAgd2hpbGUgKHBvcyA8IHRleHQubGVuZ3RoKSB7XHJcbiAgICBjb25zdCBpZHggPSB0ZXh0LmluZGV4T2YoJzo6OicsIHBvcyk7XHJcbiAgICBpZiAoaWR4ID09PSAtMSkgcmV0dXJuIC0xO1xyXG4gICAgaWYgKCFpc0VzY2FwZWRBdCh0ZXh0LCBpZHgpKSB7XHJcbiAgICAgIHJldHVybiBpZHg7XHJcbiAgICB9XHJcbiAgICBwb3MgPSBpZHggKyAzO1xyXG4gIH1cclxuICByZXR1cm4gLTE7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQYXJzZSB0aGUgZW50aXJlIHNvdXJjZSB0ZXh0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTb3VyY2UodGV4dDogc3RyaW5nKTogU291cmNlUGFyc2VSZXN1bHQge1xyXG4gIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgY29uc3QgbGluZUluZm8gPSBuZXcgTWFwPG51bWJlciwgQ2xhc3NJbmZvPigpO1xyXG4gIGNvbnN0IGJsb2NrczogQmxvY2tJbmZvW10gPSBbXTtcclxuICBjb25zdCBjb2RlQmxvY2tMaW5lcyA9IG5ldyBTZXQ8bnVtYmVyPigpO1xyXG4gIFxyXG4gIGxldCBpbkNvZGVCbG9jayA9IGZhbHNlO1xyXG4gIGxldCBjb2RlQmxvY2tTdGFydExpbmUgPSAtMTtcclxuICBsZXQgY3VycmVudEJsb2NrOiB7IHN0YXJ0TGluZTogbnVtYmVyOyBjbGFzc2VzOiBzdHJpbmdbXTsgdHlwZTogJ3RhYmxlJyB8ICdsaXN0JyB8ICdnZW5lcmFsJyB9IHwgbnVsbCA9IG51bGw7XHJcbiAgXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xyXG4gICAgY29uc3QgdHJpbW1lZExpbmUgPSBsaW5lLnRyaW0oKTtcclxuICAgIFxyXG4gICAgLy8gSGFuZGxlIGNvZGUgYmxvY2tzXHJcbiAgICBpZiAodHJpbW1lZExpbmUuc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgICAgaWYgKCFpbkNvZGVCbG9jaykge1xyXG4gICAgICAgIGluQ29kZUJsb2NrID0gdHJ1ZTtcclxuICAgICAgICBjb2RlQmxvY2tTdGFydExpbmUgPSBpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENoZWNrIGZvciBjbGFzczogYGBgbGFuZyA6OjogY2xhc3NcclxuICAgICAgICBjb25zdCBtYXJrZXJQb3MgPSBmaW5kVW5lc2NhcGVkTWFya2VyKHRyaW1tZWRMaW5lKTtcclxuICAgICAgICBpZiAobWFya2VyUG9zICE9PSAtMSkge1xyXG4gICAgICAgICAgY29uc3QgYWZ0ZXJNYXJrZXIgPSB0cmltbWVkTGluZS5zbGljZShtYXJrZXJQb3MgKyAzKS50cmltKCk7XHJcbiAgICAgICAgICBjb25zdCBjbGFzc2VzID0gcGFyc2VDbGFzc2VzKGFmdGVyTWFya2VyKTtcclxuICAgICAgICAgIGlmIChjbGFzc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbGluZUluZm8uc2V0KGksIHsgdHlwZTogJ2NvZGUtYmxvY2snLCBjbGFzc2VzIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpbkNvZGVCbG9jayA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAobGV0IGogPSBjb2RlQmxvY2tTdGFydExpbmU7IGogPD0gaTsgaisrKSB7XHJcbiAgICAgICAgICBjb2RlQmxvY2tMaW5lcy5hZGQoaik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoaW5Db2RlQmxvY2spIGNvbnRpbnVlO1xyXG4gICAgXHJcbiAgICAvLyBCbG9jayBlbmQ6IDo6OlxyXG4gICAgaWYgKC9eOjo6XFxzKiQvLnRlc3QodHJpbW1lZExpbmUpICYmIGN1cnJlbnRCbG9jaykge1xyXG4gICAgICBibG9ja3MucHVzaCh7XHJcbiAgICAgICAgc3RhcnRMaW5lOiBjdXJyZW50QmxvY2suc3RhcnRMaW5lLFxyXG4gICAgICAgIGVuZExpbmU6IGksXHJcbiAgICAgICAgY2xhc3NlczogY3VycmVudEJsb2NrLmNsYXNzZXMsXHJcbiAgICAgICAgdHlwZTogY3VycmVudEJsb2NrLnR5cGUsXHJcbiAgICAgIH0pO1xyXG4gICAgICBsaW5lSW5mby5zZXQoaSwgeyB0eXBlOiAnYmxvY2stZW5kJywgY2xhc3NlczogY3VycmVudEJsb2NrLmNsYXNzZXMgfSk7XHJcbiAgICAgIGN1cnJlbnRCbG9jayA9IG51bGw7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBCbG9jayBzdGFydDogOjo6IGNsYXNzXHJcbiAgICBjb25zdCBibG9ja1N0YXJ0TWF0Y2ggPSB0cmltbWVkTGluZS5tYXRjaCgvXjo6OlxccyooW1xcdy1dKyg/Olxccyo6XFxzKltcXHctXSspKilcXHMqJC8pO1xyXG4gICAgaWYgKGJsb2NrU3RhcnRNYXRjaCAmJiAhY3VycmVudEJsb2NrKSB7XHJcbiAgICAgIGNvbnN0IGNsYXNzZXMgPSBwYXJzZUNsYXNzZXMoYmxvY2tTdGFydE1hdGNoWzFdKTtcclxuICAgICAgaWYgKGNsYXNzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGxldCBibG9ja1R5cGU6ICd0YWJsZScgfCAnbGlzdCcgfCAnZ2VuZXJhbCcgPSAnZ2VuZXJhbCc7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgbGluZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gbGluZXNbal0udHJpbSgpO1xyXG4gICAgICAgICAgaWYgKCFuZXh0TGluZSkgY29udGludWU7XHJcbiAgICAgICAgICBpZiAobmV4dExpbmUuc3RhcnRzV2l0aCgnfCcpKSB7IGJsb2NrVHlwZSA9ICd0YWJsZSc7IGJyZWFrOyB9XHJcbiAgICAgICAgICBpZiAoL15bLSorXVxccy8udGVzdChuZXh0TGluZSkgfHwgL15cXGQrXFwuXFxzLy50ZXN0KG5leHRMaW5lKSkgeyBibG9ja1R5cGUgPSAnbGlzdCc7IGJyZWFrOyB9XHJcbiAgICAgICAgICBpZiAobmV4dExpbmUuc3RhcnRzV2l0aCgnOjo6JykpIGJyZWFrO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN1cnJlbnRCbG9jayA9IHsgc3RhcnRMaW5lOiBpLCBjbGFzc2VzLCB0eXBlOiBibG9ja1R5cGUgfTtcclxuICAgICAgICBsaW5lSW5mby5zZXQoaSwgeyB0eXBlOiAnYmxvY2stc3RhcnQnLCBjbGFzc2VzIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBNYXJrIGxpbmVzIGluc2lkZSBhIGJsb2NrXHJcbiAgICBpZiAoY3VycmVudEJsb2NrKSB7XHJcbiAgICAgIGxpbmVJbmZvLnNldChpLCB7IHR5cGU6ICdibG9jay1jb250ZW50JywgY2xhc3NlczogY3VycmVudEJsb2NrLmNsYXNzZXMgfSk7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBIZWFkZXI6ICMgSGVhZGVyIHRleHQgOjo6IGNsYXNzXHJcbiAgICBjb25zdCBoZWFkZXJNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rPylcXHMrOjo6XFxzKihbXFx3LV0rKD86XFxzKjpcXHMqW1xcdy1dKykqKVxccyokLyk7XHJcbiAgICBpZiAoaGVhZGVyTWF0Y2ggJiYgZmluZFVuZXNjYXBlZE1hcmtlcih0cmltbWVkTGluZSkgIT09IC0xKSB7XHJcbiAgICAgIGNvbnN0IGNsYXNzZXMgPSBwYXJzZUNsYXNzZXMoaGVhZGVyTWF0Y2hbM10pO1xyXG4gICAgICBpZiAoY2xhc3Nlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgbGluZUluZm8uc2V0KGksIHsgdHlwZTogJ2hlYWRlcicsIGNsYXNzZXMsIGNvbnRlbnRXaXRob3V0TWFya2VyOiBoZWFkZXJNYXRjaFsyXS50cmltKCkgfSk7XHJcbiAgICAgIH1cclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENhbGxvdXQ6ID4gWyF0eXBlXSBUaXRsZSA6OjogY2xhc3NcclxuICAgIGNvbnN0IGNhbGxvdXRNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9ePlxccypcXFshKFxcdyspXFxdKC4qPylcXHMqOjo6XFxzKihbXFx3LV0rKD86XFxzKjpcXHMqW1xcdy1dKykqKVxccyokLyk7XHJcbiAgICBpZiAoY2FsbG91dE1hdGNoICYmIGZpbmRVbmVzY2FwZWRNYXJrZXIodHJpbW1lZExpbmUpICE9PSAtMSkge1xyXG4gICAgICBjb25zdCBjbGFzc2VzID0gcGFyc2VDbGFzc2VzKGNhbGxvdXRNYXRjaFszXSk7XHJcbiAgICAgIGlmIChjbGFzc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBsaW5lSW5mby5zZXQoaSwgeyB0eXBlOiAnY2FsbG91dCcsIGNsYXNzZXMsIGNvbnRlbnRXaXRob3V0TWFya2VyOiBjYWxsb3V0TWF0Y2hbMl0udHJpbSgpIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICByZXR1cm4geyBsaW5lSW5mbywgYmxvY2tzLCBjb2RlQmxvY2tMaW5lcyB9O1xyXG59XHJcblxyXG4vKipcclxuICogUGFyc2UgaW5saW5lIHRleHQgc3ludGF4OiA6OjogY2xhc3MgOiBjb250ZW50IDo6OlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSW5saW5lVGV4dCh0ZXh0OiBzdHJpbmcpOiBJbmxpbmVUZXh0TWF0Y2hbXSB7XHJcbiAgY29uc3QgbWF0Y2hlczogSW5saW5lVGV4dE1hdGNoW10gPSBbXTtcclxuICBjb25zdCByZWdleCA9IC86OjooLis/KTo6Oi9nO1xyXG4gIGxldCBtYXRjaDogUmVnRXhwRXhlY0FycmF5IHwgbnVsbDtcclxuICBcclxuICB3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyh0ZXh0KSkgIT09IG51bGwpIHtcclxuICAgIGlmIChpc0VzY2FwZWRBdCh0ZXh0LCBtYXRjaC5pbmRleCkpIGNvbnRpbnVlO1xyXG4gICAgXHJcbiAgICBjb25zdCBjbG9zZVBvcyA9IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoIC0gMztcclxuICAgIGlmIChpc0VzY2FwZWRBdCh0ZXh0LCBjbG9zZVBvcykpIGNvbnRpbnVlO1xyXG4gICAgXHJcbiAgICBjb25zdCBpbm5lciA9IG1hdGNoWzFdLnRyaW0oKTtcclxuICAgIGNvbnN0IGxhc3RDb2xvbkluZGV4ID0gaW5uZXIubGFzdEluZGV4T2YoJzonKTtcclxuICAgIGlmIChsYXN0Q29sb25JbmRleCA9PT0gLTEpIGNvbnRpbnVlO1xyXG4gICAgXHJcbiAgICBjb25zdCBjbGFzc2VzU3RyID0gaW5uZXIuc2xpY2UoMCwgbGFzdENvbG9uSW5kZXgpLnRyaW0oKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBpbm5lci5zbGljZShsYXN0Q29sb25JbmRleCArIDEpLnRyaW0oKTtcclxuICAgIFxyXG4gICAgaWYgKCFjb250ZW50IHx8ICFjbGFzc2VzU3RyKSBjb250aW51ZTtcclxuICAgIFxyXG4gICAgY29uc3QgY2xhc3NlcyA9IHBhcnNlQ2xhc3NlcyhjbGFzc2VzU3RyKTtcclxuICAgIGlmIChjbGFzc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbWF0Y2hlcy5wdXNoKHsgc3RhcnQ6IG1hdGNoLmluZGV4LCBlbmQ6IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLCBjbGFzc2VzLCBjb250ZW50IH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gbWF0Y2hlcztcclxufVxyXG5cclxuLyoqXHJcbiAqIFVuZXNjYXBlIHRleHRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1bmVzY2FwZVRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gdGV4dC5yZXBsYWNlKC9cXFxcOjo6L2csICc6OjonKTtcclxufSIsICIvKipcclxuICogTWFya2Rvd24gUG9zdCBQcm9jZXNzb3JcclxuICovXHJcblxyXG5pbXBvcnQgeyBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBDb21wb25lbnQgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFxyXG4gIHBhcnNlU291cmNlLCBcclxuICBwYXJzZUlubGluZVRleHQsIFxyXG4gIHVuZXNjYXBlVGV4dCxcclxuICBwYXJzZUNsYXNzZXMsXHJcbiAgQ2xhc3NJbmZvLFxyXG4gIEJsb2NrSW5mbyBcclxufSBmcm9tICcuL3BhcnNlcic7XHJcblxyXG5mdW5jdGlvbiBnZXRDbGVhblRleHQoZWw6IEVsZW1lbnQpOiBzdHJpbmcge1xyXG4gIGNvbnN0IGNsb25lID0gZWwuY2xvbmVOb2RlKHRydWUpIGFzIEVsZW1lbnQ7XHJcbiAgY2xvbmUucXVlcnlTZWxlY3RvckFsbCgnc3ZnLCAuY29sbGFwc2UtaW5kaWNhdG9yLCAuaGVhZGluZy1jb2xsYXBzZS1pbmRpY2F0b3IsIC5saXN0LWJ1bGxldCwgaW5wdXQsIGJ1dHRvbicpLmZvckVhY2goZSA9PiBlLnJlbW92ZSgpKTtcclxuICByZXR1cm4gY2xvbmUudGV4dENvbnRlbnQgfHwgJyc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZU1hcmtlckZyb21FbGVtZW50KGVsOiBFbGVtZW50KTogdm9pZCB7XHJcbiAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihlbCwgTm9kZUZpbHRlci5TSE9XX1RFWFQpO1xyXG4gIGNvbnN0IHRleHROb2RlczogVGV4dFtdID0gW107XHJcbiAgbGV0IG5vZGU6IFRleHQgfCBudWxsO1xyXG4gIFxyXG4gIHdoaWxlICgobm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpIGFzIFRleHQgfCBudWxsKSkge1xyXG4gICAgdGV4dE5vZGVzLnB1c2gobm9kZSk7XHJcbiAgfVxyXG4gIFxyXG4gIGZvciAoY29uc3QgdGV4dE5vZGUgb2YgdGV4dE5vZGVzKSB7XHJcbiAgICBjb25zdCB0ZXh0ID0gdGV4dE5vZGUudGV4dENvbnRlbnQgfHwgJyc7XHJcbiAgICBjb25zdCBuZXdUZXh0ID0gdGV4dFxyXG4gICAgICAucmVwbGFjZSgvXFxzKjo6OlxccypbXFx3XFxzOi4tXSokLywgJycpXHJcbiAgICAgIC5yZXBsYWNlKC9eXFxzKjo6OlxccyokLywgJycpO1xyXG4gICAgXHJcbiAgICBpZiAobmV3VGV4dCAhPT0gdGV4dCkge1xyXG4gICAgICB0ZXh0Tm9kZS50ZXh0Q29udGVudCA9IG5ld1RleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IGJycyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2JyJyk7XHJcbiAgYnJzLmZvckVhY2goYnIgPT4ge1xyXG4gICAgY29uc3QgbmV4dCA9IGJyLm5leHRTaWJsaW5nO1xyXG4gICAgaWYgKG5leHQ/Lm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xyXG4gICAgICBjb25zdCBuZXh0VGV4dCA9IG5leHQudGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgaWYgKG5leHRUZXh0ID09PSAnOjo6JyB8fCAvXjo6OlxccyokLy50ZXN0KG5leHRUZXh0KSkge1xyXG4gICAgICAgIG5leHQudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBleHRyYWN0Q2xhc3Nlc0Zyb21UZXh0KHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHwgbnVsbCB7XHJcbiAgY29uc3QgbWF0Y2ggPSB0ZXh0Lm1hdGNoKC86OjpcXHMqKFtcXHctXSsoPzpcXHMqOlxccypbXFx3LV0rKSopXFxzKiQvKTtcclxuICBpZiAobWF0Y2gpIHtcclxuICAgIHJldHVybiBwYXJzZUNsYXNzZXMobWF0Y2hbMV0pO1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEN1c3RvbUNsYXNzUG9zdFByb2Nlc3NvciB7XHJcbiAgcHJpdmF0ZSBjb21wb25lbnQ6IENvbXBvbmVudDtcclxuXHJcbiAgY29uc3RydWN0b3IoY29tcG9uZW50OiBDb21wb25lbnQpIHtcclxuICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50O1xyXG4gIH1cclxuXHJcbiAgcHJvY2VzcyhlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCk6IHZvaWQge1xyXG4gICAgY29uc3QgaW5mbyA9IGN0eC5nZXRTZWN0aW9uSW5mbyhlbCk7XHJcbiAgICBcclxuICAgIGlmIChpbmZvKSB7XHJcbiAgICAgIGNvbnN0IHsgdGV4dCwgbGluZVN0YXJ0LCBsaW5lRW5kIH0gPSBpbmZvO1xyXG4gICAgICBjb25zdCBwYXJzZVJlc3VsdCA9IHBhcnNlU291cmNlKHRleHQpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHBhcnNlUmVzdWx0LmNvZGVCbG9ja0xpbmVzLmhhcyhsaW5lU3RhcnQpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLnByb2Nlc3NXaXRoU291cmNlKGVsLCBsaW5lU3RhcnQsIGxpbmVFbmQsIHBhcnNlUmVzdWx0KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRE9NLWJhc2VkIHByb2Nlc3NpbmcgKEFMV0FZUyBydW5zIGFzIGZhbGxiYWNrIGZvciBQREYgZXhwb3J0KVxyXG4gICAgdGhpcy5wcm9jZXNzSGVhZGVyc0RPTShlbCk7XHJcbiAgICB0aGlzLnByb2Nlc3NMaXN0SXRlbXNET00oZWwpO1xyXG4gICAgdGhpcy5wcm9jZXNzQ2FsbG91dHNET00oZWwpO1xyXG4gICAgdGhpcy5wcm9jZXNzSW5saW5lQ29kZURPTShlbCk7XHJcbiAgICBcclxuICAgIC8vIFByb2Nlc3MgaW5saW5lIHRleHQgc3ludGF4XHJcbiAgICB0aGlzLnByb2Nlc3NJbmxpbmVUZXh0KGVsKTtcclxuICAgIFxyXG4gICAgLy8gQ2xlYW51cFxyXG4gICAgdGhpcy5jbGVhbnVwQmxvY2tNYXJrZXJzKGVsKTtcclxuICAgIHRoaXMudW5lc2NhcGVNYXJrZXJzKGVsKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcHJvY2Vzc1dpdGhTb3VyY2UoXHJcbiAgICBlbDogSFRNTEVsZW1lbnQsXHJcbiAgICBsaW5lU3RhcnQ6IG51bWJlcixcclxuICAgIGxpbmVFbmQ6IG51bWJlcixcclxuICAgIHJlc3VsdDogYW55XHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBsaW5lSW5mbyA9IHJlc3VsdC5saW5lSW5mby5nZXQobGluZVN0YXJ0KTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBibG9jayBvZiByZXN1bHQuYmxvY2tzKSB7XHJcbiAgICAgIGlmIChsaW5lU3RhcnQgPj0gYmxvY2suc3RhcnRMaW5lICYmIGxpbmVFbmQgPD0gYmxvY2suZW5kTGluZSkge1xyXG4gICAgICAgIHRoaXMuYXBwbHlCbG9ja0NvbnRlbnRDbGFzc2VzKGVsLCBibG9jaywgbGluZVN0YXJ0ID09PSBibG9jay5zdGFydExpbmUsIGxpbmVFbmQgPj0gYmxvY2suZW5kTGluZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghbGluZUluZm8pIHJldHVybjtcclxuICAgIFxyXG4gICAgc3dpdGNoIChsaW5lSW5mby50eXBlKSB7XHJcbiAgICAgIGNhc2UgJ2hlYWRlcic6XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzSGVhZGVyU291cmNlKGVsLCBsaW5lSW5mbyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2NhbGxvdXQnOlxyXG4gICAgICAgIHRoaXMucHJvY2Vzc0NhbGxvdXRTb3VyY2UoZWwsIGxpbmVJbmZvKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYmxvY2stc3RhcnQnOlxyXG4gICAgICAgIHRoaXMuaGlkZU1hcmtlcihlbCk7XHJcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLWNjcy1ibG9jay1zdGFydCcsIGxpbmVJbmZvLmNsYXNzZXMuam9pbignICcpKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYmxvY2stZW5kJzpcclxuICAgICAgICB0aGlzLmhpZGVNYXJrZXIoZWwpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRE9NLWJhc2VkIGhlYWRlciBwcm9jZXNzaW5nIChmYWxsYmFjayBmb3IgUERGIGV4cG9ydClcclxuICAgKi9cclxuICBwcml2YXRlIHByb2Nlc3NIZWFkZXJzRE9NKGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3QgaGVhZGVycyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2gxLCBoMiwgaDMsIGg0LCBoNSwgaDYnKTtcclxuICAgIFxyXG4gICAgaGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7XHJcbiAgICAgIGlmIChoZWFkZXIuaGFzQXR0cmlidXRlKCdkYXRhLWNjcy1wcm9jZXNzZWQnKSkgcmV0dXJuO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgdGV4dCA9IGdldENsZWFuVGV4dChoZWFkZXIpO1xyXG4gICAgICBjb25zdCBjbGFzc2VzID0gZXh0cmFjdENsYXNzZXNGcm9tVGV4dCh0ZXh0KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChjbGFzc2VzICYmIGNsYXNzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKC4uLmNsYXNzZXMpO1xyXG4gICAgICAgIGhlYWRlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtY2NzLXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcbiAgICAgICAgcmVtb3ZlTWFya2VyRnJvbUVsZW1lbnQoaGVhZGVyKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBET00tYmFzZWQgbGlzdCBpdGVtIHByb2Nlc3NpbmdcclxuICAgKi9cclxuICBwcml2YXRlIHByb2Nlc3NMaXN0SXRlbXNET00oZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBsaXN0SXRlbXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdsaScpO1xyXG4gICAgXHJcbiAgICBsaXN0SXRlbXMuZm9yRWFjaChsaSA9PiB7XHJcbiAgICAgIGlmIChsaS5oYXNBdHRyaWJ1dGUoJ2RhdGEtY2NzLXByb2Nlc3NlZCcpKSByZXR1cm47XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB0ZXh0ID0gZ2V0Q2xlYW5UZXh0KGxpKTtcclxuICAgICAgY29uc3QgY2xhc3NlcyA9IGV4dHJhY3RDbGFzc2VzRnJvbVRleHQodGV4dCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoY2xhc3NlcyAmJiBjbGFzc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBsaS5jbGFzc0xpc3QuYWRkKC4uLmNsYXNzZXMpO1xyXG4gICAgICAgIGxpLnNldEF0dHJpYnV0ZSgnZGF0YS1jY3MtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICByZW1vdmVNYXJrZXJGcm9tRWxlbWVudChsaSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRE9NLWJhc2VkIGNhbGxvdXQgcHJvY2Vzc2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcHJvY2Vzc0NhbGxvdXRzRE9NKGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3QgY2FsbG91dHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuY2FsbG91dCcpO1xyXG4gICAgXHJcbiAgICBjYWxsb3V0cy5mb3JFYWNoKGNhbGxvdXQgPT4ge1xyXG4gICAgICBpZiAoY2FsbG91dC5oYXNBdHRyaWJ1dGUoJ2RhdGEtY2NzLXByb2Nlc3NlZCcpKSByZXR1cm47XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB0aXRsZUlubmVyID0gY2FsbG91dC5xdWVyeVNlbGVjdG9yKCcuY2FsbG91dC10aXRsZS1pbm5lcicpO1xyXG4gICAgICBpZiAoIXRpdGxlSW5uZXIpIHJldHVybjtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHRleHQgPSB0aXRsZUlubmVyLnRleHRDb250ZW50IHx8ICcnO1xyXG4gICAgICBjb25zdCBjbGFzc2VzID0gZXh0cmFjdENsYXNzZXNGcm9tVGV4dCh0ZXh0KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChjbGFzc2VzICYmIGNsYXNzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNhbGxvdXQuY2xhc3NMaXN0LmFkZCguLi5jbGFzc2VzKTtcclxuICAgICAgICBjYWxsb3V0LnNldEF0dHJpYnV0ZSgnZGF0YS1jY3MtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICByZW1vdmVNYXJrZXJGcm9tRWxlbWVudCh0aXRsZUlubmVyKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBET00tYmFzZWQgaW5saW5lIGNvZGUgcHJvY2Vzc2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcHJvY2Vzc0lubGluZUNvZGVET00oZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBjb2RlRWxlbWVudHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdjb2RlOm5vdChwcmUgY29kZSknKTtcclxuICAgIFxyXG4gICAgY29kZUVsZW1lbnRzLmZvckVhY2goY29kZSA9PiB7XHJcbiAgICAgIGlmIChjb2RlLmhhc0F0dHJpYnV0ZSgnZGF0YS1jY3MtcHJvY2Vzc2VkJykpIHJldHVybjtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gY29kZS5uZXh0U2libGluZztcclxuICAgICAgaWYgKG5leHRTaWJsaW5nPy5ub2RlVHlwZSAhPT0gTm9kZS5URVhUX05PREUpIHJldHVybjtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHRleHQgPSBuZXh0U2libGluZy50ZXh0Q29udGVudCB8fCAnJztcclxuICAgICAgXHJcbiAgICAgIC8vIFNraXAgZXNjYXBlZFxyXG4gICAgICBpZiAodGV4dC50cmltU3RhcnQoKS5zdGFydHNXaXRoKCdcXFxcOjo6JykpIHJldHVybjtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCgvXlxccyo6OjpcXHMqKFtcXHctXSsoPzpcXHMqOlxccypbXFx3LV0rKSopLyk7XHJcbiAgICAgIGlmICghbWF0Y2gpIHJldHVybjtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGNsYXNzZXMgPSBwYXJzZUNsYXNzZXMobWF0Y2hbMV0pO1xyXG4gICAgICBcclxuICAgICAgaWYgKGNsYXNzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvZGUuY2xhc3NMaXN0LmFkZCguLi5jbGFzc2VzKTtcclxuICAgICAgICBjb2RlLnNldEF0dHJpYnV0ZSgnZGF0YS1jY3MtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICBuZXh0U2libGluZy50ZXh0Q29udGVudCA9IHRleHQuc2xpY2UobWF0Y2hbMF0ubGVuZ3RoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTb3VyY2UtYmFzZWQgaGVhZGVyIHByb2Nlc3NpbmdcclxuICAgKi9cclxuICBwcml2YXRlIHByb2Nlc3NIZWFkZXJTb3VyY2UoZWw6IEhUTUxFbGVtZW50LCBpbmZvOiBDbGFzc0luZm8pOiB2b2lkIHtcclxuICAgIGNvbnN0IGhlYWRlciA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2gxLCBoMiwgaDMsIGg0LCBoNSwgaDYnKTtcclxuICAgIGlmIChoZWFkZXIgJiYgIWhlYWRlci5oYXNBdHRyaWJ1dGUoJ2RhdGEtY2NzLXByb2Nlc3NlZCcpKSB7XHJcbiAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKC4uLmluZm8uY2xhc3Nlcyk7XHJcbiAgICAgIGhlYWRlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtY2NzLXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcbiAgICAgIHJlbW92ZU1hcmtlckZyb21FbGVtZW50KGhlYWRlcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTb3VyY2UtYmFzZWQgY2FsbG91dCBwcm9jZXNzaW5nXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBwcm9jZXNzQ2FsbG91dFNvdXJjZShlbDogSFRNTEVsZW1lbnQsIGluZm86IENsYXNzSW5mbyk6IHZvaWQge1xyXG4gICAgY29uc3QgY2FsbG91dCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5jYWxsb3V0Jyk7XHJcbiAgICBpZiAoY2FsbG91dCAmJiAhY2FsbG91dC5oYXNBdHRyaWJ1dGUoJ2RhdGEtY2NzLXByb2Nlc3NlZCcpKSB7XHJcbiAgICAgIGNhbGxvdXQuY2xhc3NMaXN0LmFkZCguLi5pbmZvLmNsYXNzZXMpO1xyXG4gICAgICBjYWxsb3V0LnNldEF0dHJpYnV0ZSgnZGF0YS1jY3MtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHRpdGxlSW5uZXIgPSBjYWxsb3V0LnF1ZXJ5U2VsZWN0b3IoJy5jYWxsb3V0LXRpdGxlLWlubmVyJyk7XHJcbiAgICAgIGlmICh0aXRsZUlubmVyKSB7XHJcbiAgICAgICAgcmVtb3ZlTWFya2VyRnJvbUVsZW1lbnQodGl0bGVJbm5lcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgaGlkZU1hcmtlcihlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICBlbC5jbGFzc0xpc3QuYWRkKCdjY3MtbWFya2VyJyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFwcGx5QmxvY2tDb250ZW50Q2xhc3NlcyhcclxuICAgIGVsOiBIVE1MRWxlbWVudCwgXHJcbiAgICBibG9jazogQmxvY2tJbmZvLCBcclxuICAgIGlzU3RhcnQ6IGJvb2xlYW4sXHJcbiAgICBjb250YWluc0VuZDogYm9vbGVhblxyXG4gICk6IHZvaWQge1xyXG4gICAgaWYgKGlzU3RhcnQpIHtcclxuICAgICAgdGhpcy5oaWRlTWFya2VyKGVsKTtcclxuICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLWNjcy1ibG9jay1zdGFydCcsIGJsb2NrLmNsYXNzZXMuam9pbignICcpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzd2l0Y2ggKGJsb2NrLnR5cGUpIHtcclxuICAgICAgY2FzZSAndGFibGUnOlxyXG4gICAgICAgIGNvbnN0IHRhYmxlID0gZWwucXVlcnlTZWxlY3RvcigndGFibGUnKTtcclxuICAgICAgICBpZiAodGFibGUpIHRhYmxlLmNsYXNzTGlzdC5hZGQoLi4uYmxvY2suY2xhc3Nlcyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2xpc3QnOlxyXG4gICAgICAgIGNvbnN0IGxpc3QgPSBlbC5xdWVyeVNlbGVjdG9yKCd1bCwgb2wnKTtcclxuICAgICAgICBpZiAobGlzdCkgbGlzdC5jbGFzc0xpc3QuYWRkKC4uLmJsb2NrLmNsYXNzZXMpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoLi4uYmxvY2suY2xhc3Nlcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChjb250YWluc0VuZCkge1xyXG4gICAgICB0aGlzLnJlbW92ZUJsb2NrRW5kTWFya2VyKGVsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVtb3ZlQmxvY2tFbmRNYXJrZXIoZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKGVsLCBOb2RlRmlsdGVyLlNIT1dfVEVYVCk7XHJcbiAgICBjb25zdCB0ZXh0Tm9kZXM6IFRleHRbXSA9IFtdO1xyXG4gICAgbGV0IG5vZGU6IFRleHQgfCBudWxsO1xyXG4gICAgXHJcbiAgICB3aGlsZSAoKG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKSBhcyBUZXh0IHwgbnVsbCkpIHtcclxuICAgICAgdGV4dE5vZGVzLnB1c2gobm9kZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZvciAobGV0IGkgPSB0ZXh0Tm9kZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgY29uc3QgdGV4dE5vZGUgPSB0ZXh0Tm9kZXNbaV07XHJcbiAgICAgIGNvbnN0IHRleHQgPSB0ZXh0Tm9kZS50ZXh0Q29udGVudCB8fCAnJztcclxuICAgICAgXHJcbiAgICAgIGlmICgvXlxccyo6OjpcXHMqJC8udGVzdCh0ZXh0KSkge1xyXG4gICAgICAgIHRleHROb2RlLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgY29uc3QgcHJldiA9IHRleHROb2RlLnByZXZpb3VzU2libGluZztcclxuICAgICAgICBpZiAocHJldj8ubm9kZU5hbWUgPT09ICdCUicpIHByZXYucmVtb3ZlKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmICh0ZXh0LmluY2x1ZGVzKCc6OjonKSkge1xyXG4gICAgICAgIHRleHROb2RlLnRleHRDb250ZW50ID0gdGV4dC5yZXBsYWNlKC9cXHMqOjo6XFxzKiQvLCAnJyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2xlYW51cEJsb2NrTWFya2VycyhlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2Njcy1tYXJrZXInKSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKGVsLCBOb2RlRmlsdGVyLlNIT1dfVEVYVCk7XHJcbiAgICBjb25zdCB0ZXh0Tm9kZXM6IFRleHRbXSA9IFtdO1xyXG4gICAgbGV0IG5vZGU6IFRleHQgfCBudWxsO1xyXG4gICAgXHJcbiAgICB3aGlsZSAoKG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKSBhcyBUZXh0IHwgbnVsbCkpIHtcclxuICAgICAgdGV4dE5vZGVzLnB1c2gobm9kZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgdGV4dE5vZGUgb2YgdGV4dE5vZGVzKSB7XHJcbiAgICAgIGNvbnN0IHRleHQgPSB0ZXh0Tm9kZS50ZXh0Q29udGVudCB8fCAnJztcclxuICAgICAgXHJcbiAgICAgIGlmICgvXlxccyo6OjpcXHMqJC8udGVzdCh0ZXh0LnRyaW0oKSkpIHtcclxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0ZXh0Tm9kZS5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIGlmIChwYXJlbnQgJiYgIXBhcmVudC5jbG9zZXN0KCcuY2NzLWlubGluZScpKSB7XHJcbiAgICAgICAgICB0ZXh0Tm9kZS50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgICAgICAgY29uc3QgcHJldiA9IHRleHROb2RlLnByZXZpb3VzU2libGluZztcclxuICAgICAgICAgIGlmIChwcmV2Py5ub2RlTmFtZSA9PT0gJ0JSJykgcHJldi5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcHJvY2Vzc0lubGluZVRleHQoZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdjY3MtbWFya2VyJykpIHJldHVybjtcclxuICAgIFxyXG4gICAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihcclxuICAgICAgZWwsXHJcbiAgICAgIE5vZGVGaWx0ZXIuU0hPV19URVhULFxyXG4gICAgICB7XHJcbiAgICAgICAgYWNjZXB0Tm9kZTogKG5vZGUpID0+IHtcclxuICAgICAgICAgIGNvbnN0IHRleHQgPSBub2RlLnRleHRDb250ZW50IHx8ICcnO1xyXG4gICAgICAgICAgY29uc3QgcGFyZW50ID0gbm9kZS5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIXRleHQuaW5jbHVkZXMoJzo6OicpKSByZXR1cm4gTm9kZUZpbHRlci5GSUxURVJfU0tJUDtcclxuICAgICAgICAgIGlmIChwYXJlbnQ/LmNsb3Nlc3QoJy5jY3MtaW5saW5lLCAuY2NzLW1hcmtlciwgY29kZSwgcHJlLCBzdmcnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gTm9kZUZpbHRlci5GSUxURVJfU0tJUDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgcmV0dXJuIE5vZGVGaWx0ZXIuRklMVEVSX0FDQ0VQVDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgdGV4dE5vZGVzOiBUZXh0W10gPSBbXTtcclxuICAgIGxldCBub2RlOiBUZXh0IHwgbnVsbDtcclxuICAgIHdoaWxlICgobm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpIGFzIFRleHQgfCBudWxsKSkge1xyXG4gICAgICB0ZXh0Tm9kZXMucHVzaChub2RlKTtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGNvbnN0IHRleHROb2RlIG9mIHRleHROb2Rlcykge1xyXG4gICAgICBjb25zdCB0ZXh0ID0gdGV4dE5vZGUudGV4dENvbnRlbnQgfHwgJyc7XHJcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBwYXJzZUlubGluZVRleHQodGV4dCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAobWF0Y2hlcy5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyZW50ID0gdGV4dE5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgaWYgKCFwYXJlbnQpIGNvbnRpbnVlO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICAgIGxldCBsYXN0SW5kZXggPSAwO1xyXG4gICAgICBcclxuICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XHJcbiAgICAgICAgaWYgKG1hdGNoLnN0YXJ0ID4gbGFzdEluZGV4KSB7XHJcbiAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0LnNsaWNlKGxhc3RJbmRleCwgbWF0Y2guc3RhcnQpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgc3Bhbi5jbGFzc05hbWUgPSBbJ2Njcy1pbmxpbmUnLCAuLi5tYXRjaC5jbGFzc2VzXS5qb2luKCcgJyk7XHJcbiAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IG1hdGNoLmNvbnRlbnQ7XHJcbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoc3Bhbik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGFzdEluZGV4ID0gbWF0Y2guZW5kO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAobGFzdEluZGV4IDwgdGV4dC5sZW5ndGgpIHtcclxuICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0LnNsaWNlKGxhc3RJbmRleCkpKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcGFyZW50LnJlcGxhY2VDaGlsZChmcmFnbWVudCwgdGV4dE5vZGUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1bmVzY2FwZU1hcmtlcnMoZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKGVsLCBOb2RlRmlsdGVyLlNIT1dfVEVYVCk7XHJcbiAgICBjb25zdCBub2Rlc1RvQ2xlYW46IFRleHRbXSA9IFtdO1xyXG4gICAgbGV0IG5vZGU6IFRleHQgfCBudWxsO1xyXG4gICAgXHJcbiAgICB3aGlsZSAoKG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKSBhcyBUZXh0IHwgbnVsbCkpIHtcclxuICAgICAgaWYgKG5vZGUudGV4dENvbnRlbnQ/LmluY2x1ZGVzKCdcXFxcOjo6JykpIHtcclxuICAgICAgICBub2Rlc1RvQ2xlYW4ucHVzaChub2RlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBub2Rlc1RvQ2xlYW4uZm9yRWFjaCh0ZXh0Tm9kZSA9PiB7XHJcbiAgICAgIHRleHROb2RlLnRleHRDb250ZW50ID0gdW5lc2NhcGVUZXh0KHRleHROb2RlLnRleHRDb250ZW50IHx8ICcnKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBvc3RQcm9jZXNzb3IoY29tcG9uZW50OiBDb21wb25lbnQpIHtcclxuICBjb25zdCBwcm9jZXNzb3IgPSBuZXcgQ3VzdG9tQ2xhc3NQb3N0UHJvY2Vzc29yKGNvbXBvbmVudCk7XHJcbiAgcmV0dXJuIChlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCkgPT4ge1xyXG4gICAgcHJvY2Vzc29yLnByb2Nlc3MoZWwsIGN0eCk7XHJcbiAgfTtcclxufSIsICIvKipcclxuICogUGx1Z2luIFNldHRpbmdzXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB0eXBlIEN1c3RvbUNsYXNzUGx1Z2luIGZyb20gJy4vbWFpbic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbUNsYXNzU2V0dGluZ3Mge1xyXG4gIGVuYWJsZUxpdmVQcmV2aWV3OiBib29sZWFuO1xyXG4gIGVuYWJsZVJlYWRpbmdWaWV3OiBib29sZWFuO1xyXG4gIHNob3dDbGFzc0xhYmVsczogYm9vbGVhbjtcclxuICBpbmNsdWRlU25pcHBldHNJblBkZjogYm9vbGVhbjtcclxuICBjdXN0b21DU1M6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEN1c3RvbUNsYXNzU2V0dGluZ3MgPSB7XHJcbiAgZW5hYmxlTGl2ZVByZXZpZXc6IHRydWUsXHJcbiAgZW5hYmxlUmVhZGluZ1ZpZXc6IHRydWUsXHJcbiAgc2hvd0NsYXNzTGFiZWxzOiBmYWxzZSxcclxuICBpbmNsdWRlU25pcHBldHNJblBkZjogdHJ1ZSxcclxuICBjdXN0b21DU1M6ICcnLFxyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIEN1c3RvbUNsYXNzU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gIHBsdWdpbjogQ3VzdG9tQ2xhc3NQbHVnaW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEN1c3RvbUNsYXNzUGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdDdXN0b20gQ2xhc3MgU3ludGF4IFNldHRpbmdzJyB9KTtcclxuXHJcbiAgICAvLyBTeW50YXggUmVmZXJlbmNlXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdTeW50YXgnIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCBzeW50YXhSZWYgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoKTtcclxuICAgIHN5bnRheFJlZi5pbm5lckhUTUwgPSBgXHJcbiAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7IHBhZGRpbmc6IDFlbTsgYm9yZGVyLXJhZGl1czogNnB4OyBmb250LXNpemU6IDAuODVlbTsgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcIj5cclxuICAgICAgICA8ZGl2PiMgSGVhZGVyIDo6OiBjbGFzczwvZGl2PlxyXG4gICAgICAgIDxkaXY+LSBMaXN0IGl0ZW0gOjo6IGNsYXNzPC9kaXY+XHJcbiAgICAgICAgPGRpdj4tIFsgXSBUYXNrIDo6OiBjbGFzczwvZGl2PlxyXG4gICAgICAgIDxkaXY+PiBbIW5vdGVdIFRpdGxlIDo6OiBjbGFzczwvZGl2PlxyXG4gICAgICAgIDxkaXY+XFxgY29kZVxcYCA6OjogY2xhc3M8L2Rpdj5cclxuICAgICAgICA8ZGl2Pjo6OiBjbGFzczwvZGl2PlxyXG4gICAgICAgIDxkaXY+Jm5ic3A7Jm5ic3A7YmxvY2sgY29udGVudDwvZGl2PlxyXG4gICAgICAgIDxkaXY+Ojo6PC9kaXY+XHJcbiAgICAgICAgPGRpdj46OjogY2xhc3MgOiBpbmxpbmUgdGV4dCA6Ojo8L2Rpdj5cclxuICAgICAgICA8ZGl2PlxcXFw6OjogZXNjYXBlZCA6Ojo8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICBgO1xyXG5cclxuICAgIC8vIEdlbmVyYWwgU2V0dGluZ3NcclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0dlbmVyYWwnIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnRW5hYmxlIGluIExpdmUgUHJldmlldycpXHJcbiAgICAgIC5zZXREZXNjKCdTaG93IHN5bnRheCBoaWdobGlnaHRpbmcgaW4gZWRpdG9yJylcclxuICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaXZlUHJldmlldylcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpdmVQcmV2aWV3ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1Nob3cgQ2xhc3MgTGFiZWxzJylcclxuICAgICAgLnNldERlc2MoJ1Nob3cgY2xhc3MgbmFtZXMgYWJvdmUgYmxvY2sgZWxlbWVudHMnKVxyXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDbGFzc0xhYmVscylcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDbGFzc0xhYmVscyA9IHZhbHVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlU3R5bGVzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgIC8vIFBERiBFeHBvcnRcclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1BERiBFeHBvcnQnIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnSW5jbHVkZSBDU1MgU25pcHBldHMgaW4gUERGJylcclxuICAgICAgLnNldERlc2MoJ0VtYmVkIGVuYWJsZWQgQ1NTIHNuaXBwZXRzIHdoZW4gZXhwb3J0aW5nIHRvIFBERicpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZVNuaXBwZXRzSW5QZGYpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlU25pcHBldHNJblBkZiA9IHZhbHVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdSZWZyZXNoIFNuaXBwZXRzIENhY2hlJylcclxuICAgICAgLnNldERlc2MoJ01hbnVhbGx5IHJlbG9hZCBDU1Mgc25pcHBldHMgZnJvbSBET00nKVxyXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PlxyXG4gICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1JlZnJlc2gnKVxyXG4gICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5yZWZyZXNoU25pcHBldHMoKTtcclxuICAgICAgICAgICAgbmV3IE5vdGljZSgnU25pcHBldHMgY2FjaGUgcmVmcmVzaGVkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAvLyBTaG93IGNhY2hlZCBzbmlwcGV0cyBpbmZvXHJcbiAgICBjb25zdCBzbmlwcGV0c0NTUyA9IHRoaXMucGx1Z2luLmdldFNuaXBwZXRzQ1NTKCk7XHJcbiAgICBjb25zdCBpbmZvRGl2ID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XHJcbiAgICBpbmZvRGl2LnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogMC41ZW07IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTsgYm9yZGVyLXJhZGl1czogNHB4OyBmb250LXNpemU6IDAuODVlbTsnO1xyXG4gICAgXHJcbiAgICBpZiAoc25pcHBldHNDU1MpIHtcclxuICAgICAgY29uc3QgbGluZXMgPSBzbmlwcGV0c0NTUy5zcGxpdCgnXFxuJykubGVuZ3RoO1xyXG4gICAgICBpbmZvRGl2LmlubmVySFRNTCA9IGA8c3BhbiBzdHlsZT1cImNvbG9yOiB2YXIoLS10ZXh0LXN1Y2Nlc3MpO1wiPlx1MjcxMzwvc3Bhbj4gQ2FjaGVkICR7bGluZXN9IGxpbmVzIG9mIENTUyBmcm9tIHNuaXBwZXRzYDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGluZm9EaXYuaW5uZXJIVE1MID0gYDxzcGFuIHN0eWxlPVwiY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1wiPk5vIHNuaXBwZXRzIGNhY2hlZC4gTWFrZSBzdXJlIHNuaXBwZXRzIGFyZSBlbmFibGVkIGluIEFwcGVhcmFuY2Ugc2V0dGluZ3MuPC9zcGFuPmA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3VzdG9tIENTU1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ3VzdG9tIENTUycgfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdBZGRpdGlvbmFsIENTUycpXHJcbiAgICAgIC5zZXREZXNjKCdDdXN0b20gQ1NTIChhbHNvIGluY2x1ZGVkIGluIFBERiBleHBvcnQpJylcclxuICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignLm15LWNsYXNzIHtcXG4gIGNvbG9yOiByZWQ7XFxufScpXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ1NTKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jIHZhbHVlID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ1NTID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgdGV4dC5pbnB1dEVsLnJvd3MgPSAxMDtcclxuICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUud2lkdGggPSAnMTAwJSc7XHJcbiAgICAgICAgdGV4dC5pbnB1dEVsLnN0eWxlLmZvbnRGYW1pbHkgPSAndmFyKC0tZm9udC1tb25vc3BhY2UpJztcclxuICAgICAgfSk7XHJcbiAgfVxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBLElBQUFBLG1CQUF1Qjs7O0FDQ3ZCLGtCQU1PO0FBQ1AsbUJBQTJDO0FBRzNDLElBQU0sV0FBVztBQUFBO0FBQUEsRUFFZixRQUFRO0FBQUE7QUFBQSxFQUdSLFdBQVc7QUFBQTtBQUFBLEVBR1gsU0FBUztBQUFBO0FBQUEsRUFHVCxZQUFZO0FBQUE7QUFBQSxFQUdaLGFBQWE7QUFBQTtBQUFBLEVBR2IsV0FBVztBQUNiO0FBR0EsSUFBTSxtQkFBbUIsdUJBQVcsS0FBSyxFQUFFLE9BQU8sb0JBQW9CLENBQUM7QUFDdkUsSUFBTSxrQkFBa0IsdUJBQVcsS0FBSyxFQUFFLE9BQU8saUJB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O0FBR0QsUUFBSTtBQUVGLFlBQU0sWUFBWSxLQUFLLElBQUk7QUFDM0IsVUFBSSx1Q0FBVyxVQUFVO0FBQ3ZCLGNBQU0sa0JBQWtCLE1BQU0sS0FBSyxVQUFVLG1CQUFtQixDQUFDLENBQUM7QUFDbEUsbUJBQVcsQ0FBQyxLQUFLLEtBQUssS0FBSyxPQUFPLFFBQVEsVUFBVSxRQUFRLEdBQUc7QUFDN0QsY0FBSSxPQUFPLFVBQVUsWUFBWSxnQkFBZ0IsS0FBSyxPQUFLLElBQUksU0FBUyxDQUFDLENBQUMsR0FBRztBQUMzRSxnQkFBSSxDQUFDLFVBQVUsS0FBSyxPQUFLLEVBQUUsU0FBUyxNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHO0FBQ3hELHdCQUFVLEtBQUssTUFBTSxHQUFHO0FBQUEsRUFBUSxLQUFLLEVBQUU7QUFBQSxZQUN6QztBQUFBLFVBQ0Y7QUFBQSxRQUNGO0FBQUEsTUFDRjtBQUFBLElBQ0YsU0FBUyxHQUFHO0FBQ1YsY0FBUSxNQUFNLHVDQUF1QyxDQUFDO0FBQUEsSUFDeEQ7QUFFQSxTQUFLLG1CQUFtQixVQUFVLEtBQUssTUFBTTtBQUM3QyxZQUFRLElBQUksZUFBZSxVQUFVLE1BQU0sb0JBQW9CLEtBQUssaUJBQWlCLE1BQU0sU0FBUztBQUFBLEVBQ3RHO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsSUFBaUI7QUFDdkMsVUFBTSxZQUFZLEdBQUcsUUFBUSw2RUFBNkU7QUFDMUcsUUFBSSxDQUFDLFVBQVc7QUFFaEIsUUFBSSxVQUFVLGNBQWMsd0JBQXdCLEVBQUc7QUFFdkQsUUFBSSxNQUFNO0FBQUE7QUFBQTtBQUVWLFFBQUksS0FBSyxTQUFTLHdCQUF3QixLQUFLLGtCQUFrQjtBQUMvRCxhQUFPO0FBQUE7QUFBQSxFQUFpQyxLQUFLLGdCQUFnQjtBQUFBO0FBQUEsSUFDL0Q7QUFFQSxRQUFJLEtBQUssU0FBUyxXQUFXO0FBQzNCLGFBQU87QUFBQTtBQUFBLEVBQStCLEtBQUssU0FBUyxTQUFTO0FBQUE7QUFBQSxJQUMvRDtBQUVBLFdBQU87QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT1AsVUFBTSxVQUFVLFNBQVMsY0FBYyxPQUFPO0FBQzlDLFlBQVEsS0FBSztBQUNiLFlBQVEsY0FBYztBQUN0QixjQUFVLGFBQWEsU0FBUyxVQUFVLFVBQVU7QUFBQSxFQUN0RDtBQUFBLEVBRUEsaUJBQXlCO0FBQ3ZCLFdBQU8sS0FBSztBQUFBLEVBQ2Q7QUFBQSxFQUVBLGtCQUFrQjtBQUNoQixTQUFLLHFCQUFxQjtBQUFBLEVBQzVCO0FBQUEsRUFFQSxlQUFlO0FBQ2IsU0FBSyxpQkFBaUI7QUFBQSxFQUN4QjtBQUFBLEVBRVEsZUFBZTtBQS9MekI7QUFnTUksZUFBSyxZQUFMLG1CQUFjO0FBQ2QsU0FBSyxVQUFVO0FBQ2YsYUFBUyxpQkFBaUIsd0JBQXdCLEVBQUUsUUFBUSxRQUFNLEdBQUcsT0FBTyxDQUFDO0FBQUEsRUFDL0U7QUFDRjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImlzRXNjYXBlZEF0IiwgIm5vZGUiXQp9Cg==
